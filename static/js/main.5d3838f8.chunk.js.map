{"version":3,"sources":["AuthContext.js","utils/constants.js","utils/index.js","utils/update.js","components/PollToggle/index.js","components/Admin/SetUserPermissionsDialog.js","components/Admin/UserRemoveDialog.js","components/Admin/index.js","components/Search/SearchBar.js","components/NotificationList.js","components/Layout/Header.js","components/Layout/SideMenu.js","components/Layout/Body.js","components/Layout/index.js","utils/token.js","components/ProfileList.js","components/Channel/AddChannelDialog.js","components/ChannelList.js","components/Dm/AddDmDialog.js","components/DmList.js","components/ProfileChannelLists.js","components/WorkspaceStats.js","pages/HomePage.js","components/Channel/AddMemberDialog.js","components/Message/AddMessageTimerDialog.js","components/Message/AddMessage.js","components/Dm/DmMessages.js","components/Message/MessagePin.js","components/Message/MessageReact.js","components/Message/MessageRemove.js","components/Message/MessageEdit.js","components/Message/MessageShareDialog.js","components/Message/index.js","components/Channel/ChannelMessages.js","components/Placeholder.js","components/Channel/index.js","pages/ChannelPage.js","components/Dm/AddDmMemberDialog.js","components/Dm/index.js","pages/DmPage.js","pages/LoginPage.js","pages/RegisterPage.js","pages/ForgotPasswordPage.js","pages/ResetPasswordPage.js","components/Profile/EditableFields.js","components/Profile/UserStats.js","components/Profile/index.js","pages/ProfilePage.js","components/Search/index.js","pages/SearchPage.js","components/Layout/ProtectedRoute.js","axios.js","utils/text.js","App.js","serviceWorker.js","theme.js","index.js"],"names":["AuthContext","React","createContext","AuthProvider","Provider","Consumer","require","config","url","console","log","PERMISSION_IDS","useInterval","callback","delay","savedCallback","useRef","useEffect","current","id","setInterval","clearInterval","isMatchingId","a","b","parseInt","stepSubscribers","subscribeToStep","subscriber","interval","undefined","find","o","push","unsubscribeToStep","unsubscriber","filter","step","iter","forEach","useStep","watches","shouldSubscribe","isPolling","count","options","PollToggle","useState","open","setOpen","anchorRef","selectedIndex","setSelectedIndex","handleMenuItemClick","event","index","handleClose","contains","target","ButtonGroup","variant","color","ref","aria-label","style","marginRight","Button","onClick","disabled","size","aria-owns","aria-haspopup","prevOpen","Popper","anchorEl","transition","disablePortal","TransitionProps","placement","Grow","transformOrigin","Paper","ClickAwayListener","onClickAway","MenuList","map","option","MenuItem","key","selected","SetUserPermissionsDialog","children","permissionId","setPermissionId","users","setUsers","selectedUser","setSelectedUser","token","useContext","axios","get","params","then","data","catch","err","Dialog","onClose","aria-labelledby","DialogTitle","onSubmit","preventDefault","value","u_id","permission_id","post","Number","response","DialogContent","DialogContentText","Grid","container","spacing","direction","justify","alignItems","item","xs","Select","width","onChange","newUserId","d","idx","name_first","name_last","RadioGroup","name","newPermissionId","row","FormControlLabel","control","Radio","label","labelPlacement","DialogActions","type","UserRemoveDialog","delete","Admin","buttonRef","aria-controls","keepMounted","useStyles","makeStyles","theme","search","position","borderRadius","shape","backgroundColor","fade","palette","common","white","marginLeft","breakpoints","up","searchIcon","height","pointerEvents","display","justifyContent","inputRoot","inputInput","padding","transitions","create","withRouter","props","classes","query_str","setQueryStr","history","className","InputBase","placeholder","root","input","inputProps","e","NotificationList","notifs","setNotifs","notifications","length","notif","dm_id","component","Link","to","channel_id","notification_message","appBar","menuButton","title","flexGrow","logoutButton","float","Header","handleMenuToggle","useTheme","matches","useMediaQuery","loggedOut","setLoggedOut","localStorage","removeItem","AppBar","Toolbar","IconButton","edge","textDecoration","Typography","noWrap","drawer","flexShrink","drawerPaper","toolbar","mixins","paddingLeft","SideMenu","Hidden","smUp","implementation","Drawer","anchor","paper","ModalProps","Divider","xsDown","body","Body","Layout","menu","extractUId","getItem","ProfileList","uid","List","ListItem","button","ListItemIcon","ListItemText","primary","AddChannelDialog","is_public","checked","TextField","autoFocus","margin","fullWidth","Switch","ChannelList","curr_channel_id","myChannels","setMyChannels","allChannels","setAllChannels","fetchChannelsData","getMyChannels","getAllChannels","all","spread","myChannelResponse","allChannelResponse","myChannelData","channels","filteredChannels","channel","c","subheader","ListSubheader","flex","MenuProps","PaperProps","maxHeight","ITEM_HEIGHT","AddDmDialog","selectedUsers","setSelectedUsers","u_ids","multiple","Input","DmList","curr_dm_id","myDms","setMyDms","fetchDmsData","ProfileChannelLists","WorkspaceStats","utilizationRate","setUtilizationRate","channelsData","setChannelsData","dmsData","setDmsData","messagesData","setMessagesData","dreams_stats","obj","x","Date","y","error","toFixed","datasets","fill","borderColor","showLine","scales","xAxes","gridLines","lineWidth","time","unitStepSize","displayFormats","millisecond","second","minute","hour","day","week","month","quarter","year","HomePage","paddingTop","AddMemberDialog","AddMessageTimerDialog","onTimerChange","selectedDate","setSelectedDate","toDate","KeyboardButtonProps","flexDirection","alignSelf","rightIcon","standupTimer","AddMessage","currentMessage","setCurrentMessage","currentTimer","setCurrentTimer","timerDialogOpen","setTimerDialogOpen","onAdd","StepContext","onAddDm","StepContextDm","isTimerSet","standupRemaining","setStandupRemaining","standupEndTime","setStandupEndTime","submitMessage","message","trim","route","time_sent","getTime","startsWith","found","match","alert","isNaN","isInteger","time_finish","now","Math","round","checkStandupActive","is_active","multiline","onKeyDown","getModifierState","InputProps","endAdornment","InputAdornment","StepProvider","DmMessages","messages","setMessages","pagination","setPagination","fetchDmMessages","p","dmId","start","isPaginating","currentStart","newMessages","end","currentEnd","sliceStart","isEnd","pinnedMessages","m","is_pinned","min","message_id","slice","reverse","PAGINATION_SIZE","withTheme","isPinned","setIsPinned","stepDm","path","mdiPin","action","active","mdiPinOutline","MessageReact","reacts","thumbUpCount","is_reacted","thumbUpIndex","findIndex","react","react_id","is_this_user_reacted","Badge","anchorOrigin","horizontal","vertical","badgeContent","messageReact","fontSize","MessageRemove","MessageEdit","prompt","put","MessageShareDialog","og_message_id","selectedChannel","setSelectedChannel","selectedDm","setSelectedDm","selectedChDm","setSelectedChDm","channelsShare","setChannelsShare","dmsShare","setDmsShare","setMessage","rowsMax","Message","time_created","is_unread","nameFirst","setNameFirst","nameLast","setNameLast","imgUrl","setImgUrl","fullName","s","join","initials","user","email","handle_str","profile_img_url","ListItemAvatar","Avatar","border","src","timeago","secondary","fontFamily","ChannelMessages","fetchChannelMessages","channelId","Placeholder","CircularProgress","Channel","loading","setLoading","setName","members","setMembers","owners","setOwners","fetchChannelData","owner_members","all_members","finally","userIsMember","member","userIsOwner","owner","viewerIsOwner","viewerIsMember","toUpperCase","href","removeOwner","addOwner","leaveChannel","joinChannel","ChannelPage","AddDmMemberDialog","Dm","membersList","setMembersList","fetchDmData","leaveDm","removeDm","DmPage","light","card","background","marginTop","LoginPage","setAuth","Container","maxWidth","Box","boxShadow","noValidate","password","auth_user_id","required","autoComplete","RegisterPage","values","setValues","handleChange","ForgotPasswordPage","reset_code","new_password","EditableFields","editable","master","masterValue","slaves","slaveValues","onSave","edit","setEdit","prevMasterValue","setPrevMasterValue","currMasterValue","setCurrMasterValue","prevSlaveValues","setPrevSlaveValues","currSlaveValues","setCurrSlaveValues","toggleEdit","slave","readOnly","valueIndex","copySlaves","val","onSlaveChange","cursor","UserStats","involvementRate","setInvolvementRate","user_stats","Profile","profile","profileDetails","setProfileDetails","toString","passed_props","raw_text","x_start","y_start","x_end","y_end","items","split","img_url","ProfilePage","Search","Array","isArray","marginBottom","LinearProgress","SearchPage","ProtectedRoute","defaults","baseURL","headers","CancelToken","interceptors","request","use","responseMessage","_","toast","Promise","reject","App","document","authDetails","setAuthDetails","setItem","exact","render","ResetPasswordPage","Boolean","window","location","hostname","createMuiTheme","main","red","A400","default","ReactDOM","ThemeProvider","utils","MomentUtils","CssBaseline","autoClose","hideProgressBar","newestOnTop","closeOnClick","rtl","pauseOnVisibilityChange","draggable","pauseOnHover","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.5d3838f8.chunk.js","sourcesContent":["import React from 'react';\r\n\r\nconst AuthContext = React.createContext();\r\n\r\nexport const AuthProvider = AuthContext.Provider;\r\nexport const AuthConsumer = AuthContext.Consumer;\r\nexport default AuthContext;\r\n","require(\"dotenv\").config();\n\nexport const url = \"https://comp1531-project-backend.onrender.com\";\nconsole.log(\"Using backend at \" + url);\n\nexport const drawerWidth = 240;\nexport const PERMISSION_IDS = {\n  OWNER: 1,\n  MEMBER: 2\n};\nexport const PAGINATION_SIZE = 50;\nexport const SLICE_SIZE = 10;\n","// from: https://overreacted.io/making-setinterval-declarative-with-react-hooks/\r\nimport { useEffect, useRef } from 'react';\r\n\r\nexport function useInterval(callback, delay) {\r\n    const savedCallback = useRef();\r\n\r\n    // Remember the latest callback.\r\n    useEffect(() => {\r\n        savedCallback.current = callback;\r\n    }, [callback]);\r\n\r\n    // Set up the interval.\r\n    useEffect(() => {\r\n        function tick() {\r\n        savedCallback.current();\r\n        }\r\n        if (delay !== null) {\r\n        let id = setInterval(tick, delay);\r\n        return () => clearInterval(id);\r\n        }\r\n    }, [delay]);\r\n}\r\n\r\nexport const isMatchingId = (a,b) => parseInt(a,10) === parseInt(b,10)\r\n","import React from 'react';\r\nimport {useInterval} from './index';\r\n\r\nexport let stepSubscribers = [];\r\n\r\nexport const subscribeToStep = (subscriber, interval=1) => {\r\n    if (stepSubscribers.find(o => o.subscriber === subscriber) !== undefined) return;\r\n    stepSubscribers.push({ subscriber, interval });\r\n}\r\nexport const unsubscribeToStep = (unsubscriber) => stepSubscribers = stepSubscribers.filter(o => o.subscriber !== unsubscriber);\r\n\r\nexport const step = (iter) => {\r\n    stepSubscribers.forEach(o => {\r\n        console.log(iter, o.interval, iter % o.interval == 0, o.subscriber)\r\n        if (!iter || iter % o.interval == 0) {\r\n            o.subscriber()\r\n        }\r\n    });\r\n}\r\n\r\nexport const useStep = (subscriber, watches=[], interval=1) => {\r\n    const shouldSubscribe = subscriber && typeof subscriber === \"function\";\r\n    React.useEffect(() => {\r\n        if (shouldSubscribe) {\r\n            subscriber();\r\n            subscribeToStep(subscriber, interval);\r\n            return () => unsubscribeToStep(subscriber);\r\n        }\r\n    }, watches);\r\n    return step;\r\n};\r\n\r\nlet isPolling = false;\r\nexport const pollingInterval = 2000;\r\nexport const getIsPolling = () => isPolling;\r\nexport const setIsPolling = bool => {\r\n    isPolling = !!bool; // force boolean type\r\n}\r\n\r\n/* IMPORTANT: Called in PollToggle */\r\nlet count = 0;\r\nexport const usePolling = () => {\r\n    useInterval(() => {\r\n        if (isPolling) step(count++);\r\n    }, pollingInterval);\r\n}\r\n","import React from 'react';\r\n\r\nimport Button from '@material-ui/core/Button';\r\nimport ButtonGroup from '@material-ui/core/ButtonGroup';\r\nimport ArrowDropDownIcon from '@material-ui/icons/ArrowDropDown';\r\nimport ClickAwayListener from '@material-ui/core/ClickAwayListener';\r\nimport Grow from '@material-ui/core/Grow';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport Popper from '@material-ui/core/Popper';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport MenuList from '@material-ui/core/MenuList';\r\nimport { getIsPolling, setIsPolling, step, usePolling } from '../../utils/update';\r\n\r\nconst options = ['Live', 'Step'];\r\n\r\nfunction PollToggle() {\r\n\r\n    const [open, setOpen] = React.useState(false);\r\n    const anchorRef = React.useRef(null);\r\n    const [selectedIndex, setSelectedIndex] = React.useState(getIsPolling() ? 0 : 1);\r\n\r\n    usePolling();\r\n\r\n    const handleClick = () => {\r\n        step();\r\n    };\r\n\r\n    const handleMenuItemClick = (event, index) => {\r\n        setIsPolling(index === 0);\r\n        setSelectedIndex(index);\r\n        setOpen(false);\r\n    };\r\n\r\n    const handleToggle = () => {\r\n        setOpen(prevOpen => !prevOpen);\r\n    };\r\n\r\n    const handleClose = event => {\r\n        if (anchorRef.current && anchorRef.current.contains(event.target)) {\r\n            return;\r\n        }\r\n        setOpen(false);\r\n    };\r\n\r\n    return (<>\r\n        <ButtonGroup\r\n            variant=\"contained\"\r\n            color=\"primary\"\r\n            ref={anchorRef}\r\n            aria-label=\"split button\"\r\n            style={{marginRight: 15}}\r\n        >\r\n            <Button onClick={handleClick} disabled={selectedIndex === 0}>{options[selectedIndex]}</Button>\r\n            <Button\r\n            color=\"primary\"\r\n            size=\"small\"\r\n            aria-owns={open ? 'menu-list-grow' : undefined}\r\n            aria-haspopup=\"true\"\r\n            onClick={handleToggle}\r\n            >\r\n            <ArrowDropDownIcon />\r\n            </Button>\r\n        </ButtonGroup>\r\n        <Popper open={open} anchorEl={anchorRef.current} transition disablePortal>\r\n            {({ TransitionProps, placement }) => (\r\n            <Grow\r\n                {...TransitionProps}\r\n                style={{\r\n                transformOrigin: placement === 'bottom' ? 'center top' : 'center bottom',\r\n                }}\r\n            >\r\n                <Paper id=\"menu-list-grow\">\r\n                <ClickAwayListener onClickAway={handleClose}>\r\n                    <MenuList>\r\n                    {options.map((option, index) => (\r\n                        <MenuItem\r\n                        key={option}\r\n                        disabled={index === 2}\r\n                        selected={index === selectedIndex}\r\n                        onClick={event => handleMenuItemClick(event, index)}\r\n                        >\r\n                        {option}\r\n                        </MenuItem>\r\n                    ))}\r\n                    </MenuList>\r\n                </ClickAwayListener>\r\n                </Paper>\r\n            </Grow>\r\n            )}\r\n        </Popper>\r\n    </>);\r\n}\r\n\r\nexport default PollToggle;","import React from \"react\";\r\nimport axios from 'axios';\r\nimport {\r\n  Dialog,\r\n  DialogTitle,\r\n  DialogActions,\r\n  DialogContent,\r\n  DialogContentText,\r\n  Button,\r\n  Grid,\r\n  FormControlLabel,\r\n  RadioGroup,\r\n  Radio,\r\n  MenuItem,\r\n  Select,\r\n} from \"@material-ui/core\";\r\nimport AuthContext from \"../../AuthContext\";\r\nimport { PERMISSION_IDS } from \"../../utils/constants\";\r\n\r\nfunction SetUserPermissionsDialog({ children, ...props }) {\r\n\r\n  const [open, setOpen] = React.useState(false);\r\n  const [permissionId, setPermissionId] = React.useState(PERMISSION_IDS.MEMBER);\r\n  const [users, setUsers] = React.useState([]);\r\n  const [selectedUser, setSelectedUser] = React.useState('');\r\n  const token = React.useContext(AuthContext);\r\n\r\n  function fetchUserData() {\r\n    axios\r\n      .get('/users/all/v1', {\r\n        params: {\r\n          token,\r\n        },\r\n      })\r\n      .then(({ data }) => {\r\n        setUsers(data['users']);\r\n      })\r\n      .catch((err) => { });\r\n  }\r\n\r\n  React.useEffect(() => {\r\n    fetchUserData();\r\n  }, []);\r\n\r\n\r\n  const handleRadioChange = event => {\r\n    const newPermissionId = parseInt(event.target.value, 10);\r\n    setPermissionId(newPermissionId);\r\n  };\r\n\r\n  const handleUserSelect = event => {\r\n    const newUserId = parseInt(event.target.value, 10);\r\n    setSelectedUser(newUserId);\r\n  };\r\n\r\n  function handleClickOpen() {\r\n    setOpen(true);\r\n  }\r\n\r\n  function handleClose() {\r\n    setOpen(false);\r\n  }\r\n\r\n  function handleSubmit(event) {\r\n    event.preventDefault();\r\n\r\n    if (!event.target[0].value) return;\r\n\r\n    const u_id = parseInt(event.target[0].value, 10);\r\n    const permission_id = parseInt(permissionId, 10);\r\n\r\n    axios\r\n      .post(`/admin/userpermission/change/v1`, {\r\n        token,\r\n        u_id: Number.parseInt(u_id),\r\n        permission_id: Number.parseInt(permission_id),\r\n      })\r\n      .then(response => {\r\n        console.log(response);\r\n      })\r\n      .catch(err => { });\r\n  }\r\n\r\n  return <>\r\n    <div onClick={handleClickOpen}>\r\n      {children}\r\n    </div>\r\n    <Dialog\r\n      open={open}\r\n      onClose={handleClose}\r\n      aria-labelledby=\"form-dialog-title\"\r\n    >\r\n      <DialogTitle id=\"form-dialog-title\">Set User Permissions</DialogTitle>\r\n      <form onSubmit={handleSubmit}>\r\n        <DialogContent>\r\n          <DialogContentText>\r\n            Select a user below to set permissions for this user\r\n                    </DialogContentText>\r\n          <Grid\r\n            container\r\n            spacing={2}\r\n            direction=\"row\"\r\n            justify=\"center\"\r\n            alignItems=\"center\"\r\n          >\r\n            <Grid item xs={12}>\r\n              <Select style={{ width: \"100%\" }} id=\"u_id\" onChange={handleUserSelect} value={selectedUser}>\r\n                {users.map((d, idx) => {\r\n                  return <MenuItem key={d.u_id} value={d.u_id}>{d.name_first} {d.name_last}</MenuItem>\r\n                })}\r\n              </Select>\r\n            </Grid>\r\n            <Grid container item justify=\"center\" alignItems=\"center\">\r\n              <RadioGroup aria-label=\"position\" name=\"position\" value={permissionId} onChange={handleRadioChange} row>\r\n                <FormControlLabel\r\n                  value={PERMISSION_IDS.MEMBER}\r\n                  control={<Radio color=\"primary\" />}\r\n                  label=\"Member\"\r\n                  labelPlacement=\"bottom\"\r\n                />\r\n                <FormControlLabel\r\n                  value={PERMISSION_IDS.OWNER}\r\n                  control={<Radio color=\"primary\" />}\r\n                  label=\"Owner\"\r\n                  labelPlacement=\"bottom\"\r\n                />\r\n              </RadioGroup>\r\n            </Grid>\r\n          </Grid>\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={handleClose} color=\"primary\">\r\n            Cancel\r\n                    </Button>\r\n          <Button onClick={handleClose} type=\"submit\" color=\"primary\">\r\n            Set\r\n                    </Button>\r\n        </DialogActions>\r\n      </form>\r\n    </Dialog>\r\n  </>;\r\n}\r\n\r\nexport default SetUserPermissionsDialog;\r\n","import React from \"react\";\r\nimport axios from 'axios';\r\nimport {\r\n  Dialog,\r\n  DialogTitle,\r\n  DialogActions,\r\n  DialogContent,\r\n  DialogContentText,\r\n  Button,\r\n  Grid,\r\n  MenuItem,\r\n  Select,\r\n} from \"@material-ui/core\";\r\nimport AuthContext from \"../../AuthContext\";\r\n\r\nfunction UserRemoveDialog({ children, ...props }) {\r\n\r\n  const [open, setOpen] = React.useState(false);\r\n  const [users, setUsers] = React.useState([]);\r\n  const [selectedUser, setSelectedUser] = React.useState('');\r\n  const token = React.useContext(AuthContext);\r\n\r\n  React.useEffect(() => {\r\n    function fetchUserData() {\r\n      axios\r\n        .get('/users/all/v1', {\r\n          params: {\r\n            token,\r\n          },\r\n        })\r\n        .then(({ data }) => {\r\n          setUsers(data['users']);\r\n        })\r\n        .catch((err) => { });\r\n    }\r\n\r\n    fetchUserData();\r\n  }, []);\r\n\r\n  const handleUserSelect = event => {\r\n    const newUserId = parseInt(event.target.value, 10);\r\n    setSelectedUser(newUserId);\r\n  };\r\n\r\n  function handleClickOpen() {\r\n    setOpen(true);\r\n  }\r\n\r\n  function handleClose() {\r\n    setOpen(false);\r\n  }\r\n\r\n  function handleSubmit(event) {\r\n    event.preventDefault();\r\n\r\n    if (!event.target[0].value) return;\r\n\r\n    const u_id = parseInt(event.target[0].value, 10);\r\n\r\n    axios\r\n      .delete(`/admin/user/remove/v1`, {\r\n        data: {\r\n          token,\r\n          u_id: Number.parseInt(u_id),\r\n        }\r\n      })\r\n      .then(response => {\r\n        console.log(response);\r\n      })\r\n      .catch(err => { });\r\n  }\r\n\r\n  return <>\r\n    <div onClick={handleClickOpen}>\r\n      {children}\r\n    </div>\r\n    <Dialog\r\n      open={open}\r\n      onClose={handleClose}\r\n      aria-labelledby=\"form-dialog-title\"\r\n    >\r\n      <DialogTitle id=\"form-dialog-title\">Remove Users</DialogTitle>\r\n      <form onSubmit={handleSubmit}>\r\n        <DialogContent>\r\n          <DialogContentText>\r\n            Select a user below to remove\r\n          </DialogContentText>\r\n          <Grid\r\n            container\r\n            spacing={2}\r\n            direction=\"row\"\r\n            justify=\"center\"\r\n            alignItems=\"center\"\r\n          >\r\n            <Grid item xs={12}>\r\n              <Select style={{ width: \"100%\" }} id=\"u_id\" onChange={handleUserSelect} value={selectedUser}>\r\n                {users.map((d, idx) => {\r\n                  return <MenuItem key={d.u_id} value={d.u_id}>{d.name_first} {d.name_last}</MenuItem>\r\n                })}\r\n              </Select>\r\n            </Grid>\r\n          </Grid>\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={handleClose} color=\"primary\">\r\n            Cancel\r\n          </Button>\r\n          <Button onClick={handleClose} type=\"submit\" color=\"primary\">\r\n            Remove\r\n          </Button>\r\n        </DialogActions>\r\n      </form>\r\n    </Dialog>\r\n  </>;\r\n}\r\n\r\nexport default UserRemoveDialog;\r\n","import React from 'react';\r\nimport Button from '@material-ui/core/Button';\r\nimport Menu from '@material-ui/core/Menu';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport SetUserPermissionsDialog from './SetUserPermissionsDialog';\r\nimport UserRemoveDialog from './UserRemoveDialog';\r\n\r\nexport default function Admin() {\r\n\r\n  const [open, setOpen] = React.useState(false);\r\n  const buttonRef = React.useRef();\r\n\r\n  const handleClick = (event) => setOpen(true);\r\n  const handleClose = () => setOpen(false);\r\n\r\n  return (\r\n    <div>\r\n      <Button\r\n        ref={buttonRef}\r\n        aria-controls=\"simple-menu\"\r\n        aria-haspopup=\"true\"\r\n        onClick={handleClick}\r\n        color=\"inherit\"\r\n      >\r\n        Admin\r\n      </Button>\r\n      <Menu\r\n        id=\"simple-menu\"\r\n        anchorEl={buttonRef.current}\r\n        keepMounted\r\n        open={open}\r\n        onClose={handleClose}\r\n      >\r\n        <SetUserPermissionsDialog>\r\n          <MenuItem onClick={handleClose}>Set User Permissions</MenuItem>\r\n        </SetUserPermissionsDialog>\r\n        <UserRemoveDialog>\r\n          <MenuItem onClick={handleClose}>Remove Users</MenuItem>\r\n        </UserRemoveDialog>\r\n        <MenuItem onClick={handleClose}>Close</MenuItem>\r\n      </Menu>\r\n    </div>\r\n  );\r\n}","import React from 'react';\r\nimport { withRouter } from 'react-router-dom';\r\nimport InputBase from '@material-ui/core/InputBase';\r\nimport { fade, makeStyles } from '@material-ui/core/styles';\r\nimport SearchIcon from '@material-ui/icons/Search';\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    search: {\r\n        position: 'relative',\r\n        borderRadius: theme.shape.borderRadius,\r\n        backgroundColor: fade(theme.palette.common.white, 0.15),\r\n        '&:hover': {\r\n        backgroundColor: fade(theme.palette.common.white, 0.25),\r\n        },\r\n        marginLeft: 0,\r\n        width: '100%',\r\n        [theme.breakpoints.up('sm')]: {\r\n        marginLeft: theme.spacing(1),\r\n        width: 'auto',\r\n        marginRight: theme.spacing(2),\r\n        },\r\n    },\r\n    searchIcon: {\r\n        width: theme.spacing(7),\r\n        height: '100%',\r\n        position: 'absolute',\r\n        pointerEvents: 'none',\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n    },\r\n    inputRoot: {\r\n        color: 'inherit',\r\n    },\r\n    inputInput: {\r\n        padding: theme.spacing(1, 1, 1, 7),\r\n        transition: theme.transitions.create('width'),\r\n        width: '100%',\r\n        [theme.breakpoints.up('sm')]: {\r\n        width: 120,\r\n        '&:focus': {\r\n            width: 200,\r\n        },\r\n        },\r\n    },\r\n}));\r\n\r\nfunction SearchBar(props) {\r\n    const classes = useStyles();\r\n\r\n    const [query_str, setQueryStr] = React.useState(\"\");\r\n\r\n    const onSubmit = () => props.history.push(`/search/${query_str}`);\r\n\r\n    return (\r\n        <form onSubmit={onSubmit}>\r\n        <div className={classes.search}>\r\n            <div className={classes.searchIcon}>\r\n                <SearchIcon />\r\n            </div>\r\n            <InputBase\r\n                placeholder=\"Search\"\r\n                classes={{\r\n                root: classes.inputRoot,\r\n                input: classes.inputInput,\r\n                }}\r\n                inputProps={{ 'aria-label': 'search' }}\r\n                value={query_str}\r\n                onChange={e => setQueryStr(e.target.value)}\r\n            />\r\n        </div>\r\n        </form>\r\n    );\r\n}\r\n\r\nexport default withRouter(SearchBar);","import React from 'react';\r\nimport axios from 'axios';\r\nimport { Link } from 'react-router-dom';\r\nimport Button from '@material-ui/core/Button';\r\nimport Menu from '@material-ui/core/Menu';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport AuthContext from '../AuthContext';\r\n\r\nexport default function NotificationList() {\r\n\r\n  const [open, setOpen] = React.useState(false);\r\n  const [notifs, setNotifs] = React.useState([]);\r\n  const buttonRef = React.useRef();\r\n  const token = React.useContext(AuthContext);\r\n\r\n  React.useEffect(() => {\r\n    const interval = setInterval(async () => {\r\n      axios\r\n        .get('/notifications/get/v1', {\r\n          params: { token },\r\n        })\r\n        .then(({ data }) => {\r\n          setNotifs(data.notifications);\r\n        })\r\n        .catch((err) => { });\r\n    }, 2000);\r\n\r\n    return () => clearInterval(interval);\r\n  }, []);\r\n\r\n  const handleClick = (event) => setOpen(true);\r\n  const handleClose = () => setOpen(false);\r\n\r\n  return (\r\n    <div>\r\n      <Button\r\n        ref={buttonRef}\r\n        aria-controls=\"simple-menu\"\r\n        aria-haspopup=\"true\"\r\n        onClick={handleClick}\r\n        color=\"inherit\"\r\n      >\r\n        Notifications\r\n      </Button>\r\n      <Menu\r\n        id=\"simple-menu\"\r\n        anchorEl={buttonRef.current}\r\n        keepMounted\r\n        open={open}\r\n        onClose={handleClose}\r\n      >\r\n        {notifs.length === 0\r\n          ? <div>&nbsp;You don't have any notifications.&nbsp;</div>\r\n          : notifs.map((notif) => {\r\n            if (notif.dm_id === -1) {\r\n              return (\r\n                <MenuItem component={Link} to={`/channel/${notif.channel_id}`}>\r\n                  {notif.notification_message}\r\n                </MenuItem>\r\n              )\r\n            } else {\r\n              return (\r\n                <MenuItem component={Link} to={`/dm/${notif.dm_id}`}>\r\n                  {notif.notification_message}\r\n                </MenuItem>\r\n              )\r\n            }\r\n          })}\r\n        <MenuItem onClick={handleClose}>Close</MenuItem>\r\n      </Menu>\r\n    </div>\r\n  );\r\n}","import axios from 'axios';\r\nimport {\r\n  AppBar,\r\n  Button,\r\n  IconButton,\r\n  Toolbar,\r\n  Typography,\r\n} from '@material-ui/core';\r\nimport { makeStyles, useTheme } from '@material-ui/core/styles';\r\nimport useMediaQuery from '@material-ui/core/useMediaQuery';\r\nimport MenuIcon from '@material-ui/icons/Menu';\r\nimport React from 'react';\r\nimport { Link, Redirect } from 'react-router-dom';\r\nimport AuthContext from '../../AuthContext';\r\nimport { drawerWidth } from '../../utils/constants';\r\nimport PollToggle from '../PollToggle';\r\nimport Admin from '../Admin';\r\nimport SearchBar from '../Search/SearchBar';\r\nimport NotificationList from '../NotificationList';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  appBar: {\r\n    marginLeft: drawerWidth,\r\n    [theme.breakpoints.up('sm')]: {\r\n      width: `calc(100% - ${drawerWidth}px)`,\r\n    },\r\n  },\r\n  menuButton: {\r\n    marginRight: theme.spacing(2),\r\n  },\r\n  title: {\r\n    flexGrow: 1,\r\n  },\r\n  logoutButton: {\r\n    float: 'right',\r\n  },\r\n}));\r\n\r\nfunction Header({ handleMenuToggle = () => { } }) {\r\n  const classes = useStyles();\r\n  const theme = useTheme();\r\n  const matches = useMediaQuery(theme.breakpoints.up('sm'));\r\n  const token = React.useContext(AuthContext);\r\n  const [loggedOut, setLoggedOut] = React.useState(false);\r\n\r\n  if (loggedOut) {\r\n    axios.post(`/auth/logout/v1`, { token })\r\n      .then((response) => {\r\n        console.log(response);\r\n      })\r\n      .catch((err) => { });\r\n    localStorage.removeItem('token');\r\n    localStorage.removeItem('u_id');\r\n    return <Redirect to=\"/login\" />;\r\n  }\r\n\r\n  return (\r\n    <AppBar position=\"fixed\" className={classes.appBar}>\r\n      <Toolbar>\r\n        {!matches && (\r\n          <>\r\n            <IconButton\r\n              color=\"inherit\"\r\n              aria-label=\"open drawer\"\r\n              edge=\"start\"\r\n              onClick={handleMenuToggle}\r\n              className={classes.menuButton}\r\n            >\r\n              <MenuIcon />\r\n            </IconButton>\r\n            <Link to=\"/\" style={{ color: 'white', textDecoration: 'none' }}>\r\n              <Typography variant=\"h5\" noWrap>\r\n                Dreams\r\n              </Typography>\r\n            </Link>\r\n          </>\r\n        )}\r\n        <div variant=\"h6\" className={classes.title}>\r\n\r\n        </div>\r\n        <div style={{ display: 'flex' }}>\r\n          <SearchBar />\r\n          <PollToggle />\r\n          <NotificationList />\r\n          <Admin />\r\n          <Button\r\n            color=\"inherit\"\r\n            className={classes.logoutButton}\r\n            onClick={() => {\r\n              setLoggedOut(true);\r\n            }}\r\n          >\r\n            Logout\r\n          </Button>\r\n        </div>\r\n      </Toolbar>\r\n    </AppBar>\r\n  );\r\n}\r\n\r\nexport default Header;\r\n","import React from 'react';\r\nimport { Divider, Drawer, Hidden, Typography } from '@material-ui/core';\r\nimport { makeStyles, useTheme } from '@material-ui/core/styles';\r\nimport { drawerWidth } from '../../utils/constants';\r\nimport { Link } from 'react-router-dom';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  drawer: {\r\n    [theme.breakpoints.up('sm')]: {\r\n      width: drawerWidth,\r\n      flexShrink: 0,\r\n    },\r\n  },\r\n  drawerPaper: {\r\n    width: drawerWidth,\r\n  },\r\n  toolbar: {\r\n    ...theme.mixins.toolbar,\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    paddingLeft: theme.spacing(2),\r\n  },\r\n}));\r\n\r\nfunction SideMenu({ container, children, open, setOpen }) {\r\n  const classes = useStyles();\r\n  const theme = useTheme();\r\n\r\n  return (\r\n    <nav className={classes.drawer} aria-label=\"channels\">\r\n      {/* The implementation can be swapped with js to avoid SEO duplication of links. */}\r\n      <Hidden smUp implementation=\"css\">\r\n        <Drawer\r\n          container={container}\r\n          variant=\"temporary\"\r\n          anchor={theme.direction === 'rtl' ? 'right' : 'left'}\r\n          open={open}\r\n          onClose={() => setOpen(false)}\r\n          classes={{\r\n            paper: classes.drawerPaper,\r\n          }}\r\n          ModalProps={{\r\n            keepMounted: true, // Better open performance on mobile.\r\n          }}\r\n        >\r\n          <div className={classes.toolbar} />\r\n          <Divider />\r\n          {children}\r\n        </Drawer>\r\n      </Hidden>\r\n      <Hidden xsDown implementation=\"css\">\r\n        <Drawer\r\n          classes={{\r\n            paper: classes.drawerPaper,\r\n          }}\r\n          variant=\"permanent\"\r\n          open\r\n        >\r\n          <div className={classes.toolbar}>\r\n            <Link to=\"/\" style={{ color: 'black', textDecoration: 'none' }}>\r\n              <Typography variant=\"h5\" noWrap>\r\n                Dreams\r\n              </Typography>\r\n            </Link>\r\n          </div>\r\n          {children}\r\n        </Drawer>\r\n      </Hidden>\r\n    </nav>\r\n  );\r\n}\r\n\r\nexport default SideMenu;\r\n","import React from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport { drawerWidth } from '../../utils/constants';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  body: {\r\n    [theme.breakpoints.up('sm')]: {\r\n      width: `calc(100% - ${drawerWidth}px)`,\r\n    },\r\n    padding: 20,\r\n  },\r\n  toolbar: theme.mixins.toolbar,\r\n}));\r\n\r\nfunction Body({ children }) {\r\n  const classes = useStyles();\r\n  return (\r\n    <div className={classes.body}>\r\n      {/* Padding */}\r\n      <div className={classes.toolbar} />\r\n      {children}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Body;\r\n","import React from 'react';\r\nimport Header from './Header';\r\nimport SideMenu from './SideMenu';\r\nimport Body from './Body';\r\n\r\nfunction Layout({ menu, body }) {\r\n  const [open, setOpen] = React.useState(false);\r\n  function handleMenuToggle() {\r\n    setOpen((open) => !!!open);\r\n  }\r\n  return (\r\n    <div style={{ display: 'flex' }}>\r\n      <Header handleMenuToggle={handleMenuToggle} />\r\n      <SideMenu open={open} setOpen={setOpen}>\r\n        {menu}\r\n      </SideMenu>\r\n      <Body>{body}</Body>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Layout;\r\n","export function extractUId(token) {\r\n  let u_id = localStorage.getItem('u_id');\r\n  if (u_id == null) {\r\n  \tu_id = -1;\r\n  }\r\n  return u_id;\r\n}\r\n","import React from 'react';\r\nimport { List, ListItem, ListItemIcon, ListItemText } from '@material-ui/core';\r\nimport AccountCircle from '@material-ui/icons/AccountCircle';\r\nimport { Link } from 'react-router-dom';\r\nimport { extractUId } from '../utils/token';\r\nimport AuthContext from '../AuthContext';\r\n\r\nfunction ProfileList() {\r\n  const uid = extractUId(React.useContext(AuthContext));\r\n  return (\r\n    <List>\r\n      <ListItem button key={'profile'} component={Link} to={`/profile/${uid}`}>\r\n        <ListItemIcon>\r\n          <AccountCircle />\r\n        </ListItemIcon>\r\n        <ListItemText primary=\"Profile\" />\r\n      </ListItem>\r\n    </List>\r\n  );\r\n}\r\n\r\nexport default ProfileList;\r\n","import React from \"react\";\r\nimport axios from 'axios';\r\nimport {\r\n  Dialog,\r\n  DialogTitle,\r\n  DialogActions,\r\n  DialogContent,\r\n  DialogContentText,\r\n  IconButton,\r\n  Button,\r\n  Switch,\r\n  TextField,\r\n  Grid,\r\n  FormControlLabel,\r\n} from \"@material-ui/core\";\r\nimport Visibility from \"@material-ui/icons/Visibility\";\r\nimport VisibilityOff from \"@material-ui/icons/VisibilityOff\";\r\nimport Add from \"@material-ui/icons/Add\";\r\nimport AuthContext from \"../../AuthContext\";\r\n\r\nfunction AddChannelDialog({ ...props }) {\r\n  const [open, setOpen] = React.useState(false);\r\n  const token = React.useContext(AuthContext);\r\n  function handleClickOpen() {\r\n    setOpen(true);\r\n  }\r\n  function handleClose() {\r\n    setOpen(false);\r\n  }\r\n  function handleSubmit(event) {\r\n    event.preventDefault();\r\n    const name = event.target[0].value;\r\n    const secret = event.target[1].checked;\r\n    const is_public = !secret;\r\n\r\n    if (!name) return;\r\n\r\n    axios\r\n      .post(`/channels/create/v2`, { token, name, is_public })\r\n      .then(response => {\r\n        console.log(response);\r\n        props.callback();\r\n      })\r\n      .catch(err => { });\r\n  }\r\n  return (\r\n    <div>\r\n      <IconButton size=\"small\" onClick={handleClickOpen}>\r\n        <Add />\r\n      </IconButton>\r\n      <Dialog\r\n        open={open}\r\n        onClose={handleClose}\r\n        aria-labelledby=\"form-dialog-title\"\r\n      >\r\n        <DialogTitle id=\"form-dialog-title\">Create Channel</DialogTitle>\r\n        <form onSubmit={handleSubmit}>\r\n          <DialogContent>\r\n            <DialogContentText>\r\n              Complete the form below to create a new channel\r\n            </DialogContentText>\r\n            <Grid\r\n              container\r\n              spacing={2}\r\n              direction=\"row\"\r\n              justify=\"center\"\r\n              alignItems=\"center\"\r\n            >\r\n              <Grid item xs={12}>\r\n                <TextField\r\n                  autoFocus\r\n                  margin=\"dense\"\r\n                  id=\"channel_name\"\r\n                  label=\"Channel Name\"\r\n                  name=\"channel_name\"\r\n                  fullWidth\r\n                />\r\n              </Grid>\r\n              <Grid container item justify=\"center\" alignItems=\"center\">\r\n                <Visibility />\r\n                <FormControlLabel\r\n                  control={\r\n                    <Switch\r\n                      value=\"secret\"\r\n                      inputProps={{ \"aria-label\": \"Secret\" }}\r\n                    />\r\n                  }\r\n                  label=\"Secret\"\r\n                  labelPlacement=\"top\"\r\n                />\r\n                <VisibilityOff />\r\n              </Grid>\r\n            </Grid>\r\n          </DialogContent>\r\n          <DialogActions>\r\n            <Button onClick={handleClose} color=\"primary\">\r\n              Cancel\r\n            </Button>\r\n            <Button onClick={handleClose} type=\"submit\" color=\"primary\">\r\n              Create\r\n            </Button>\r\n          </DialogActions>\r\n        </form>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default AddChannelDialog;\r\n","import React from 'react';\r\nimport axios from 'axios';\r\nimport { Link } from 'react-router-dom';\r\n\r\nimport {\r\n  List,\r\n  ListItem,\r\n  ListItemIcon,\r\n  ListItemText,\r\n  ListSubheader,\r\n} from '@material-ui/core';\r\n\r\nimport RadioButtonCheckedIcon from '@material-ui/icons/RadioButtonChecked';\r\nimport RadioButtonUncheckedIcon from '@material-ui/icons/RadioButtonUnchecked';\r\nimport AuthContext from '../AuthContext';\r\nimport AddChannelDialog from './Channel/AddChannelDialog';\r\n\r\nimport { useStep } from '../utils/update';\r\n\r\nfunction ChannelList({ channel_id: curr_channel_id }) {\r\n  const [myChannels, setMyChannels] = React.useState([]);\r\n  const [allChannels, setAllChannels] = React.useState([]);\r\n\r\n  const token = React.useContext(AuthContext);\r\n\r\n  const fetchChannelsData = () => {\r\n    // fetch channels data\r\n    const getMyChannels = axios.get('/channels/list/v2', { params: { token } });\r\n    const getAllChannels = axios.get('/channels/listall/v2', { params: { token } });\r\n\r\n    axios.all([getMyChannels, getAllChannels]).then(\r\n      axios.spread((myChannelResponse, allChannelResponse) => {\r\n        const myChannelData = myChannelResponse.data.channels;\r\n        const allChannelData = allChannelResponse.data.channels;\r\n        const filteredChannels = allChannelData.filter((channel) => {\r\n          return (\r\n            myChannelData.find((c) => c.channel_id === channel.channel_id) ===\r\n            undefined\r\n          );\r\n        });\r\n        setMyChannels(myChannelData);\r\n        setAllChannels(filteredChannels);\r\n      })\r\n    );\r\n  };\r\n\r\n  useStep(fetchChannelsData, [], 2);\r\n\r\n  return (\r\n    <>\r\n      <List\r\n        subheader={\r\n          <ListSubheader style={{ display: 'flex' }}>\r\n            <span style={{ flex: 1 }}>My Channels</span>\r\n            <AddChannelDialog callback={fetchChannelsData} />\r\n          </ListSubheader>\r\n        }\r\n      >\r\n        {myChannels.map(({ channel_id, name }, index) => (\r\n          <ListItem\r\n            button\r\n            key={channel_id}\r\n            component={Link}\r\n            to={`/channel/${channel_id}`}\r\n          >\r\n            <ListItemIcon>\r\n              {channel_id == curr_channel_id ? (\r\n                <RadioButtonCheckedIcon />\r\n              ) : (\r\n                <RadioButtonUncheckedIcon />\r\n              )}\r\n            </ListItemIcon>\r\n            <ListItemText primary={name} />\r\n          </ListItem>\r\n        ))}\r\n      </List>\r\n      <List subheader={<ListSubheader>Other Channels</ListSubheader>}>\r\n        {allChannels.map(({ channel_id, name }, index) => (\r\n          <ListItem\r\n            button\r\n            key={channel_id}\r\n            component={Link}\r\n            to={`/channel/${channel_id}`}\r\n          >\r\n            <ListItemIcon>\r\n              {channel_id == curr_channel_id ? (\r\n                <RadioButtonCheckedIcon />\r\n              ) : (\r\n                <RadioButtonUncheckedIcon />\r\n              )}\r\n            </ListItemIcon>\r\n            <ListItemText primary={name} />\r\n          </ListItem>\r\n        ))}\r\n      </List>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default ChannelList;\r\n","import React from \"react\";\r\nimport axios from 'axios';\r\nimport {\r\n  Dialog,\r\n  DialogTitle,\r\n  DialogActions,\r\n  DialogContent,\r\n  DialogContentText,\r\n  IconButton,\r\n  Button,\r\n  Select,\r\n  Input,\r\n  MenuItem\r\n} from \"@material-ui/core\";\r\nimport Add from \"@material-ui/icons/Add\";\r\nimport AuthContext from \"../../AuthContext\";\r\nimport { extractUId } from '../../utils/token';\r\n\r\nconst ITEM_HEIGHT = 48;\r\nconst ITEM_PADDING_TOP = 8;\r\nconst MenuProps = {\r\n  PaperProps: {\r\n    style: {\r\n      maxHeight: ITEM_HEIGHT * 4.5 + ITEM_PADDING_TOP,\r\n      width: 250,\r\n    },\r\n  },\r\n};\r\n\r\nfunction AddDmDialog({ ...props }) {\r\n  const [open, setOpen] = React.useState(false);\r\n  const [selectedUsers, setSelectedUsers] = React.useState([]);\r\n  const [users, setUsers] = React.useState([]);\r\n\r\n  const token = React.useContext(AuthContext);\r\n  const u_id = extractUId(token);\r\n\r\n  function fetchUserData() {\r\n    axios\r\n      .get('/users/all/v1', {\r\n        params: {\r\n          token,\r\n        },\r\n      })\r\n      .then(({ data }) => {\r\n        setUsers(data['users']);\r\n      })\r\n      .catch((err) => { });\r\n  }\r\n\r\n  React.useEffect(() => {\r\n    fetchUserData();\r\n  }, []);\r\n\r\n  function handleClickOpen() {\r\n    setOpen(true);\r\n  }\r\n\r\n  function handleClose() {\r\n    setOpen(false);\r\n  }\r\n\r\n  function handleUserSelect(event) {\r\n    setSelectedUsers(event.target.value);\r\n  };\r\n\r\n  function handleSubmit(event) {\r\n    event.preventDefault();\r\n\r\n    console.log(selectedUsers);\r\n\r\n    axios\r\n      .post(`/dm/create/v1`, { token, u_ids: selectedUsers })\r\n      .then(response => {\r\n        console.log(response);\r\n        props.callback();\r\n      })\r\n      .catch(err => { });\r\n  }\r\n  return (\r\n    <div>\r\n      <IconButton size=\"small\" onClick={handleClickOpen}>\r\n        <Add />\r\n      </IconButton>\r\n      <Dialog\r\n        open={open}\r\n        onClose={handleClose}\r\n        aria-labelledby=\"form-dialog-title\"\r\n      >\r\n        <DialogTitle id=\"form-dialog-title\">Create Dm</DialogTitle>\r\n        <form onSubmit={handleSubmit}>\r\n          <DialogContent>\r\n            <DialogContentText>\r\n              Select the users below to create a new dm\r\n            </DialogContentText>\r\n            <Select\r\n              multiple\r\n              value={selectedUsers}\r\n              onChange={handleUserSelect}\r\n              input={<Input />}\r\n              MenuProps={MenuProps}\r\n              style={{ width: \"100%\" }}\r\n            >\r\n              {users.map((d, idx) => {\r\n                if (u_id != d.u_id) {\r\n                  return <MenuItem key={d.u_id} value={d.u_id}>{d.name_first + ' ' + d.name_last}</MenuItem>\r\n                }\r\n              })}\r\n            </Select>\r\n          </DialogContent>\r\n          <DialogActions>\r\n            <Button onClick={handleClose} color=\"primary\">\r\n              Cancel\r\n            </Button>\r\n            <Button onClick={handleClose} type=\"submit\" color=\"primary\">\r\n              Create\r\n            </Button>\r\n          </DialogActions>\r\n        </form>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default AddDmDialog;\r\n","import React from 'react';\r\nimport axios from 'axios';\r\nimport { Link } from 'react-router-dom';\r\n\r\nimport {\r\n  List,\r\n  ListItem,\r\n  ListItemIcon,\r\n  ListItemText,\r\n  ListSubheader,\r\n} from '@material-ui/core';\r\n\r\nimport RadioButtonCheckedIcon from '@material-ui/icons/RadioButtonChecked';\r\nimport RadioButtonUncheckedIcon from '@material-ui/icons/RadioButtonUnchecked';\r\nimport AuthContext from '../AuthContext';\r\nimport AddDmDialog from './Dm/AddDmDialog';\r\n\r\nimport { useStep } from '../utils/update';\r\n\r\nfunction DmList({ dm_id: curr_dm_id }) {\r\n  const [myDms, setMyDms] = React.useState([]);\r\n\r\n  const token = React.useContext(AuthContext);\r\n\r\n  const fetchDmsData = () => {\r\n    axios\r\n      .get('/dm/list/v1', {\r\n        params: {\r\n          token,\r\n        },\r\n      })\r\n      .then(({ data }) => {\r\n        setMyDms(data['dms']);\r\n      })\r\n      .catch((err) => { });\r\n  };\r\n\r\n  useStep(fetchDmsData, [], 2);\r\n\r\n  return (\r\n    <>\r\n      <List\r\n        subheader={\r\n          <ListSubheader style={{ display: 'flex' }}>\r\n            <span style={{ flex: 1 }}>My Dms</span>\r\n            <AddDmDialog callback={fetchDmsData} />\r\n          </ListSubheader>\r\n        }\r\n      >\r\n        {myDms.map(({ dm_id, name }) => (\r\n          <ListItem\r\n            button\r\n            key={dm_id}\r\n            component={Link}\r\n            to={`/dm/${dm_id}`}\r\n          >\r\n            <ListItemIcon>\r\n              {dm_id == curr_dm_id ? (\r\n                <RadioButtonCheckedIcon />\r\n              ) : (\r\n                <RadioButtonUncheckedIcon />\r\n              )}\r\n            </ListItemIcon>\r\n            <ListItemText primary={name} />\r\n          </ListItem>\r\n        ))}\r\n      </List>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default DmList;\r\n","import React from 'react';\r\nimport ProfileList from './ProfileList';\r\nimport ChannelList from './ChannelList';\r\nimport DmList from './DmList';\r\n\r\nfunction ProfileChannelLists({ channel_id, dm_id }) {\r\n  return (\r\n    <>\r\n      <ProfileList />\r\n      <ChannelList channel_id={channel_id} />\r\n      <DmList dm_id={dm_id} />\r\n    </>\r\n  );\r\n}\r\n\r\nexport default ProfileChannelLists;\r\n","import axios from 'axios';\r\nimport React from 'react';\r\nimport { Scatter } from \"react-chartjs-2\";\r\nimport { Typography } from '@material-ui/core';\r\nimport AuthContext from '../AuthContext';\r\n\r\nfunction WorkspaceStats() {\r\n\r\n  const token = React.useContext(AuthContext);\r\n  const [utilizationRate, setUtilizationRate] = React.useState(0);\r\n  const [channelsData, setChannelsData] = React.useState([]);\r\n  const [dmsData, setDmsData] = React.useState([]);\r\n  const [messagesData, setMessagesData] = React.useState([]);\r\n\r\n  React.useEffect(() => {\r\n    axios\r\n      .get(`/users/stats/v1`, { params: { token } })\r\n      .then(({ data }) => {\r\n        console.log(data);\r\n        const { dreams_stats } = data;\r\n        setUtilizationRate(dreams_stats['utilization_rate']);\r\n        setChannelsData(dreams_stats['channels_exist'].map((obj) => {\r\n          return { x: new Date(obj['time_stamp'] * 1000), y: obj['num_channels_exist'] };\r\n        }));\r\n        setDmsData(dreams_stats['dms_exist'].map((obj) => {\r\n          return { x: new Date(obj['time_stamp'] * 1000), y: obj['num_dms_exist'] };\r\n        }));\r\n        setMessagesData(dreams_stats['messages_exist'].map((obj) => {\r\n          return { x: new Date(obj['time_stamp'] * 1000), y: obj['num_messages_exist'] };\r\n        }));\r\n      })\r\n      .catch((err) => {\r\n        console.error(err);\r\n      })\r\n  }, [token]);\r\n\r\n  return (\r\n    <>\r\n      <Typography variant=\"h5\">Workspace statistics</Typography>\r\n      <p>Wow! {(utilizationRate * 100).toFixed(2)}% utilisation</p>\r\n      <Scatter\r\n        data={{\r\n          datasets: [\r\n            {\r\n              label: \"Channels\",\r\n              data: channelsData,\r\n              fill: false,\r\n              borderColor: \"#742774\",\r\n              showLine: true,\r\n            },\r\n            {\r\n              label: \"Dms\",\r\n              data: dmsData,\r\n              fill: false,\r\n              borderColor: \"#4287f5\",\r\n              showLine: true,\r\n            },\r\n            {\r\n              label: \"Messages\",\r\n              data: messagesData,\r\n              fill: false,\r\n              borderColor: \"#bd2d4f\",\r\n              showLine: true,\r\n            },\r\n          ]\r\n        }}\r\n        options={{\r\n          scales: {\r\n            xAxes: [{\r\n              title: \"time\",\r\n              type: 'time',\r\n              gridLines: {\r\n                lineWidth: 2\r\n              },\r\n              time: {\r\n                unitStepSize: 200,\r\n                displayFormats: {\r\n                  millisecond: 'MMM DD HH:mm',\r\n                  second: 'MMM DD HH:mm',\r\n                  minute: 'MMM DD HH:mm',\r\n                  hour: 'MMM DD HH:mm',\r\n                  day: 'MMM DD',\r\n                  week: 'MMM DD',\r\n                  month: 'MMM DD',\r\n                  quarter: 'MMM DD',\r\n                  year: 'MMM DD',\r\n                }\r\n              }\r\n            }]\r\n          }\r\n        }}\r\n      />\r\n    </>\r\n  );\r\n}\r\n\r\nexport default WorkspaceStats;\r\n","import React from 'react';\r\nimport Layout from '../components/Layout';\r\nimport ProfileChannelLists from '../components/ProfileChannelLists';\r\nimport WorkspaceStats from '../components/WorkspaceStats';\r\nimport { Typography } from '@material-ui/core';\r\n\r\nfunction HomePage() {\r\n  return (\r\n    <Layout\r\n      menu={<ProfileChannelLists />}\r\n      body={\r\n        <>\r\n          <Typography variant=\"h4\">WELCOME</Typography>\r\n          <div style={{ paddingTop: 15 }}>\r\n            <Typography variant=\"body1\">\r\n              This is SengChat: agile messaging for Software Engineers\r\n            </Typography>\r\n          </div>\r\n          <br />\r\n          <WorkspaceStats />\r\n        </>\r\n      }\r\n    />\r\n  );\r\n}\r\n\r\nexport default HomePage;\r\n","import React from 'react';\r\nimport axios from 'axios';\r\n\r\nimport {\r\n  Dialog,\r\n  DialogTitle,\r\n  DialogActions,\r\n  DialogContent,\r\n  MenuItem,\r\n  Select,\r\n  DialogContentText,\r\n  Button,\r\n} from '@material-ui/core';\r\nimport AuthContext from '../../AuthContext';\r\nimport { useStep } from '../../utils/update';\r\n\r\nfunction AddMemberDialog({ channel_id, ...props }) {\r\n  const [open, setOpen] = React.useState(false);\r\n  const [selectedUser, setSelectedUser] = React.useState('');\r\n  const [users, setUsers] = React.useState([]);\r\n\r\n  const token = React.useContext(AuthContext);\r\n\r\n  const step = useStep();\r\n\r\n\r\n  function fetchUserData() {\r\n    axios\r\n      .get('/users/all/v1', {\r\n        params: {\r\n          token,\r\n        },\r\n      })\r\n      .then(({ data }) => {\r\n        setUsers(data['users']);\r\n      })\r\n      .catch((err) => { });\r\n  }\r\n\r\n  React.useEffect(() => {\r\n    fetchUserData();\r\n  }, []);\r\n\r\n  const handleUserSelect = event => {\r\n    const newUserId = parseInt(event.target.value, 10);\r\n    setSelectedUser(newUserId);\r\n  };\r\n\r\n  function handleClickOpen() {\r\n    setOpen(true);\r\n  }\r\n  function handleClose() {\r\n    setOpen(false);\r\n  }\r\n  function handleSubmit(event) {\r\n    event.preventDefault();\r\n    const u_id = selectedUser;\r\n\r\n    if (u_id == null) return;\r\n\r\n    axios.post(`/channel/invite/v2`, {\r\n      token,\r\n      u_id: Number.parseInt(u_id),\r\n      channel_id: Number.parseInt(channel_id),\r\n    })\r\n      .then((response) => {\r\n        console.log(response);\r\n        step();\r\n      })\r\n      .catch((err) => { });\r\n  }\r\n  return (\r\n    <div>\r\n      <Button variant=\"outlined\" color=\"primary\" onClick={handleClickOpen}>\r\n        Invite Member\r\n      </Button>\r\n      <Dialog\r\n        open={open}\r\n        onClose={handleClose}\r\n        aria-labelledby=\"form-dialog-title\"\r\n      >\r\n        <DialogTitle id=\"form-dialog-title\">Invite User</DialogTitle>\r\n        <form onSubmit={handleSubmit}>\r\n          <DialogContent>\r\n            <DialogContentText>\r\n              Select a user below to invite them to this channel\r\n            </DialogContentText>\r\n            <Select style={{ width: \"100%\" }} id=\"u_id\" onChange={handleUserSelect} value={selectedUser}>\r\n              {users.map((d, idx) => {\r\n                return <MenuItem key={d.u_id} value={d.u_id}>{d.name_first} {d.name_last}</MenuItem>\r\n              })}\r\n            </Select>\r\n          </DialogContent>\r\n          <DialogActions>\r\n            <Button onClick={handleClose} color=\"primary\">\r\n              Cancel\r\n            </Button>\r\n            <Button onClick={handleClose} type=\"submit\" color=\"primary\">\r\n              Invite\r\n            </Button>\r\n          </DialogActions>\r\n        </form>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default AddMemberDialog;\r\n","import {\r\n  Button,\r\n  Dialog,\r\n  DialogActions,\r\n  DialogContent,\r\n  DialogContentText,\r\n  DialogTitle,\r\n} from '@material-ui/core';\r\nimport { KeyboardTimePicker } from '@material-ui/pickers';\r\nimport React from 'react';\r\n\r\nfunction AddMessageTimerDialog({ open, handleClose, onTimerChange, ...props }) {\r\n  const [selectedDate, setSelectedDate] = React.useState(new Date());\r\n\r\n  function handleSubmit(event) {\r\n    event.preventDefault();\r\n    onTimerChange(selectedDate);\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <Dialog\r\n        open={open}\r\n        onClose={handleClose}\r\n        aria-labelledby=\"form-dialog-title\"\r\n      >\r\n        <DialogTitle id=\"form-dialog-title\">Send later</DialogTitle>\r\n        <form onSubmit={handleSubmit}>\r\n          <DialogContent>\r\n            <KeyboardTimePicker\r\n              margin=\"normal\"\r\n              id=\"time-picker\"\r\n              label=\"Time picker\"\r\n              value={selectedDate}\r\n              onChange={(d) => setSelectedDate(d.toDate())}\r\n              KeyboardButtonProps={{\r\n                'aria-label': 'change time',\r\n              }}\r\n            />\r\n            <DialogContentText>Enter a time to send</DialogContentText>\r\n          </DialogContent>\r\n          <DialogActions>\r\n            <Button onClick={handleClose} color=\"primary\">\r\n              Cancel\r\n            </Button>\r\n            <Button onClick={handleClose} type=\"submit\" color=\"primary\">\r\n              Set Time\r\n            </Button>\r\n          </DialogActions>\r\n        </form>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default AddMessageTimerDialog;\r\n","import axios from 'axios';\r\nimport {\r\n  Button,\r\n  TextField,\r\n  InputAdornment,\r\n  IconButton,\r\n  Typography,\r\n} from '@material-ui/core';\r\nimport React from 'react';\r\nimport SendIcon from '@material-ui/icons/Send';\r\nimport TimerIcon from '@material-ui/icons/Timer';\r\nimport { makeStyles } from '@material-ui/styles';\r\nimport AuthContext from '../../AuthContext';\r\nimport { StepContext } from '../Channel/ChannelMessages';\r\nimport { StepContextDm } from '../Dm/DmMessages';\r\nimport AddMessageTimerDialog from './AddMessageTimerDialog';\r\nimport { useInterval } from '../../utils';\r\nimport { useStep } from '../../utils/update';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  flex: {\r\n    display: 'flex',\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n  },\r\n  input: {\r\n    margin: theme.spacing(1),\r\n    marginRight: 0,\r\n  },\r\n  button: {\r\n    margin: theme.spacing(1),\r\n    marginLeft: 0,\r\n    alignSelf: 'stretch',\r\n  },\r\n  rightIcon: {\r\n    marginLeft: theme.spacing(1),\r\n  },\r\n  standupTimer: {\r\n    margin: theme.spacing(2),\r\n  }\r\n}));\r\n\r\nconst TIMER_INACTIVE_VALUE = -1;\r\n\r\nfunction AddMessage({ channel_id = -1, dm_id = -1 }) {\r\n\r\n  const classes = useStyles();\r\n  const [currentMessage, setCurrentMessage] = React.useState('');\r\n  const [currentTimer, setCurrentTimer] = React.useState(TIMER_INACTIVE_VALUE);\r\n  const [timerDialogOpen, setTimerDialogOpen] = React.useState(false);\r\n  const token = React.useContext(AuthContext);\r\n  let onAdd = React.useContext(StepContext);\r\n  let onAddDm = React.useContext(StepContextDm);\r\n  onAdd = onAdd ? onAdd : () => { }; // sanity check\r\n  onAddDm = onAddDm ? onAddDm : () => { }; // sanity check\r\n\r\n  const isTimerSet = currentTimer !== TIMER_INACTIVE_VALUE;\r\n\r\n  const [standupRemaining, setStandupRemaining] = React.useState();\r\n  const [standupEndTime, setStandupEndTime] = React.useState();\r\n\r\n  const submitMessage = () => {\r\n    const message = currentMessage.trim();\r\n    if (!message) return;\r\n    setCurrentMessage('');\r\n\r\n    /**\r\n     * Sending a message when a standup is active\r\n     * note: probably makes sense that this takes precedence over\r\n     *       starting a standup.\r\n     */\r\n    if (dm_id === -1 && standupRemaining && standupRemaining > 0) {\r\n      axios.post(`/standup/send/v1`, {\r\n        token,\r\n        channel_id: Number.parseInt(channel_id),\r\n        message,\r\n      })\r\n        .then(({ data }) => {\r\n          console.log(data);\r\n          onAdd();\r\n        })\r\n        .catch((err) => { });\r\n      return;\r\n    }\r\n\r\n    /**\r\n     * Sending a message when the sendlater timer has been set\r\n     */\r\n    if (isTimerSet) {\r\n      const route = dm_id === -1 ? '/message/sendlater/v1' : 'message/sendlaterdm/v1';\r\n      axios.post(route, {\r\n        token,\r\n        channel_id: Number.parseInt(channel_id),\r\n        dm_id: Number.parseInt(dm_id),\r\n        message,\r\n        time_sent: (currentTimer.getTime() / 1000), // ms to s conversion\r\n      })\r\n        .then(({ data }) => {\r\n          console.log(data);\r\n        })\r\n        .catch((err) => { });\r\n      setCurrentTimer(TIMER_INACTIVE_VALUE);\r\n      return;\r\n    }\r\n\r\n    /**\r\n     * Starting a standup (any message which starts with /standup)\r\n     */\r\n    if (dm_id === -1 && message.startsWith('/standup')) {\r\n      const re = /\\/standup\\s+([1-9][0-9]*)/;\r\n      const found = message.match(re);\r\n      if (!found || found.length < 2) {\r\n        alert('Usage: /standup <duration in seconds>');\r\n      } else {\r\n        var length = parseInt(found[1], 10);\r\n        if (isNaN(length) || !Number.isInteger(length)) {\r\n          alert('Usage: /standup <duration in seconds>');\r\n        } else {\r\n          axios.post(`/standup/start/v1`, {\r\n            token,\r\n            channel_id: Number.parseInt(channel_id),\r\n            length,\r\n          })\r\n            .then(({ data }) => {\r\n              const { time_finish } = data;\r\n              setStandupEndTime(time_finish);\r\n              alert(`You've started a standup for ${length} seconds`);\r\n            })\r\n            .catch((err) => { });\r\n        }\r\n      }\r\n      return;\r\n    }\r\n\r\n    /**\r\n     * Default message sending behaviour\r\n     */\r\n    const route = dm_id === -1 ? '/message/send/v2' : 'message/senddm/v1';\r\n    axios.post(route, {\r\n      token,\r\n      channel_id: Number.parseInt(channel_id),\r\n      dm_id: Number.parseInt(dm_id),\r\n      message,\r\n    })\r\n      .then(({ data }) => {\r\n        console.log(data);\r\n        onAdd();\r\n        onAddDm();\r\n      })\r\n      .catch((err) => { });\r\n  };\r\n\r\n  useInterval(() => {\r\n    if (standupEndTime > Date.now() / 1000) {\r\n      setStandupRemaining(() => Math.round(standupEndTime - Math.round(Date.now() / 1000)));\r\n    } else {\r\n      setStandupRemaining();\r\n    }\r\n  }, 1000);\r\n\r\n  const checkStandupActive = () => {\r\n    if (channel_id === -1) return;\r\n    axios\r\n      .get('/standup/active/v1', { params: { token, channel_id } })\r\n      .then(({ data }) => {\r\n        const { is_active = false, time_finish } = data;\r\n        if (is_active && time_finish) {\r\n          setStandupEndTime(time_finish);\r\n        } else {\r\n          setStandupRemaining(0);\r\n          setStandupEndTime(-1);\r\n        }\r\n      })\r\n      .catch((err) => { });\r\n  }\r\n\r\n  useStep(checkStandupActive, [currentMessage] /* check when user is typing */);\r\n\r\n  React.useEffect(checkStandupActive, [channel_id]);\r\n\r\n  const keyDown = (e) => {\r\n    if (e.key === 'Enter' && !e.getModifierState('Shift')) {\r\n      e.preventDefault();\r\n      submitMessage();\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      {standupRemaining > 0 && <Typography variant=\"caption\" className={classes.standupTimer}>\r\n        {`STANDUP ACTIVE: ${standupRemaining} seconds remaining`}\r\n      </Typography>}\r\n      <div className={classes.flex}>\r\n        <TextField\r\n          className={classes.input}\r\n          label=\"Send a message \"\r\n          multiline\r\n          placeholder=\"...\"\r\n          fullWidth\r\n          margin=\"normal\"\r\n          variant=\"filled\"\r\n          onKeyDown={keyDown}\r\n          value={currentMessage}\r\n          onChange={(e) => setCurrentMessage(e.target.value)}\r\n          InputProps={{\r\n            endAdornment: (\r\n              <InputAdornment position=\"end\">\r\n                <IconButton\r\n                  aria-label=\"toggle visibility\"\r\n                  disabled={standupRemaining > 0}\r\n                  onClick={() =>\r\n                    isTimerSet ? setCurrentTimer(-1) : setTimerDialogOpen(true)\r\n                  }\r\n                >\r\n                  <TimerIcon color={isTimerSet ? 'secondary' : undefined} />\r\n                </IconButton>\r\n              </InputAdornment>\r\n            ),\r\n          }}\r\n        />\r\n        <Button\r\n          className={classes.button}\r\n          variant=\"contained\"\r\n          color=\"primary\"\r\n          onClick={submitMessage}\r\n        >\r\n          Send\r\n          <SendIcon className={classes.rightIcon} />\r\n        </Button>\r\n      </div>\r\n      <AddMessageTimerDialog\r\n        open={timerDialogOpen}\r\n        handleClose={() => setTimerDialogOpen(false)}\r\n        onTimerChange={setCurrentTimer}\r\n      />\r\n    </>\r\n  );\r\n}\r\n\r\nexport default AddMessage;\r\n","import React from 'react';\r\nimport axios from 'axios';\r\n\r\nimport { List, ListSubheader, Button, ListItem } from '@material-ui/core';\r\nimport { useStep } from '../../utils/update';\r\nimport Message from '../Message';\r\nimport AuthContext from '../../AuthContext';\r\nimport AddMessage from '../Message/AddMessage';\r\nimport { PAGINATION_SIZE, SLICE_SIZE } from '../../utils/constants';\r\n\r\n\r\nexport const StepContextDm = React.createContext();\r\nexport const StepProvider = StepContextDm.Provider;\r\nexport const StepConsumer = StepContextDm.Consumer;\r\n\r\nfunction DmMessages({ dm_id = '' }) {\r\n\r\n  const [messages, setMessages] = React.useState([]);\r\n  const [pagination, setPagination] = React.useState({\r\n    \"dmId\": dm_id,\r\n    \"isPaginating\": false,\r\n    \"currentStart\": 0,\r\n    \"currentEnd\": 0,\r\n    \"sliceStart\": 0,\r\n  })\r\n  const token = React.useContext(AuthContext);\r\n\r\n  const fetchDmMessages = () => {\r\n    const p = pagination.dmId === dm_id\r\n      ? pagination\r\n      : {\r\n        \"dmId\": dm_id,\r\n        \"isPaginating\": false,\r\n        \"currentStart\": 0,\r\n        \"currentEnd\": 0,\r\n        \"sliceStart\": 0,\r\n      }\r\n    axios\r\n      .get('/dm/messages/v1', {\r\n        params: {\r\n          token,\r\n          dm_id: Number.parseInt(dm_id),\r\n          start: p.isPaginating ? p.currentStart : 0,\r\n        },\r\n      })\r\n      .then(({ data }) => {\r\n        const { messages: newMessages, start, end } = data;\r\n        setPagination({ ...p, dmId: dm_id, currentEnd: end }); // TODO: add/remove problems\r\n        setMessages(newMessages);\r\n      })\r\n      .catch((err) => { });\r\n  }\r\n  useStep(fetchDmMessages, [dm_id, pagination.currentStart]);\r\n\r\n  const onPrev = () => setPagination(({ sliceStart, currentStart, currentEnd, ...pagination }) => {\r\n\r\n    const pageSize = messages.length;\r\n\r\n    if (sliceStart + SLICE_SIZE < pageSize) {\r\n      return {\r\n        ...pagination,\r\n        currentStart,\r\n        currentEnd,\r\n        sliceStart: sliceStart + SLICE_SIZE,\r\n        isPaginating: true,\r\n      };\r\n    }\r\n\r\n    return {\r\n      ...pagination,\r\n      currentEnd,\r\n      currentStart: currentEnd,\r\n      sliceStart: 0,\r\n      isPaginating: true,\r\n    };\r\n\r\n  });\r\n\r\n  const onNext = () => setPagination(({ sliceStart, currentStart, ...pagination }) => {\r\n\r\n    if (sliceStart >= SLICE_SIZE) {\r\n      return {\r\n        ...pagination,\r\n        currentStart,\r\n        sliceStart: sliceStart - SLICE_SIZE,\r\n        isPaginating: !(currentStart == 0 && sliceStart == SLICE_SIZE)\r\n      };\r\n    }\r\n\r\n    if (currentStart >= PAGINATION_SIZE) {\r\n      if (currentStart) return {\r\n        ...pagination,\r\n        currentStart: currentStart - PAGINATION_SIZE,\r\n        sliceStart: PAGINATION_SIZE - SLICE_SIZE,\r\n      };\r\n    }\r\n\r\n    return {\r\n      ...pagination,\r\n      currentStart: 0,\r\n      sliceStart: 0,\r\n      isPaginating: false,\r\n    };\r\n\r\n  });\r\n\r\n  const { currentStart, currentEnd, sliceStart, isPaginating } = pagination;\r\n\r\n  const isEnd = currentEnd == -1 && sliceStart >= messages.length - SLICE_SIZE;\r\n\r\n  const pinnedMessages = messages.filter(m => m.is_pinned);\r\n  const subheader = !messages.length\r\n    ? `Messages (None)`\r\n    : `Messages [${currentStart + sliceStart + 1}...${Math.min(currentStart + messages.length, currentStart + sliceStart + SLICE_SIZE)}]`;\r\n\r\n  return (\r\n    <StepProvider value={fetchDmMessages}>\r\n      {pinnedMessages.length > 0 && <>\r\n        <hr />\r\n        <List subheader={<ListSubheader>Pinned Messages</ListSubheader>}>\r\n          {pinnedMessages.map(m => <Message key={m.message_id} {...m} />)}\r\n        </List>\r\n      </>}\r\n      <hr />\r\n      <List\r\n        subheader={<ListSubheader>{subheader}</ListSubheader>}\r\n        style={{ width: '100%' }}\r\n      >\r\n        {\r\n          (!isEnd &&\r\n            <ListItem>\r\n              <Button\r\n                variant=\"outlined\"\r\n                color=\"secondary\"\r\n                onClick={onPrev}\r\n              >\r\n                Previous messages\r\n              </Button>\r\n            </ListItem>\r\n          )\r\n        }\r\n        {messages.slice(sliceStart, sliceStart + SLICE_SIZE).reverse().map((message) => (\r\n          <Message key={message.message_id} {...message} />\r\n        ))}\r\n        {\r\n          (isPaginating &&\r\n            <ListItem>\r\n              <Button\r\n                variant=\"outlined\"\r\n                color=\"secondary\"\r\n                onClick={onNext}\r\n              >\r\n                Next messages\r\n              </Button>\r\n            </ListItem>\r\n          )\r\n        }\r\n      </List>\r\n      <AddMessage dm_id={dm_id} />\r\n    </StepProvider>\r\n  );\r\n}\r\n\r\nexport default DmMessages;\r\n","import React from 'react';\r\nimport axios from 'axios';\r\n\r\nimport MdiIcon from '@mdi/react';\r\nimport { mdiPin, mdiPinOutline } from '@mdi/js';\r\nimport { IconButton } from '@material-ui/core';\r\n\r\nimport { withTheme } from '@material-ui/styles';\r\n\r\nimport AuthContext from '../../AuthContext';\r\nimport { StepContext } from '../Channel/ChannelMessages';\r\nimport { StepContextDm } from '../Dm/DmMessages';\r\n\r\nfunction MessagePin({\r\n  message_id,\r\n  is_pinned = false,\r\n  theme,\r\n}) {\r\n\r\n  const [isPinned, setIsPinned] = React.useState(is_pinned);\r\n  React.useEffect(() => setIsPinned(is_pinned), [is_pinned]);\r\n\r\n  const token = React.useContext(AuthContext);\r\n  let step = React.useContext(StepContext);\r\n  let stepDm = React.useContext(StepContextDm);\r\n  step = step ? step : () => { }; // sanity check\r\n  stepDm = stepDm ? stepDm : () => { }; // sanity check\r\n\r\n  const toggle = () => {\r\n    if (isPinned) {\r\n      axios.post(`/message/unpin/v1`, {\r\n        token,\r\n        message_id: Number.parseInt(message_id),\r\n      })\r\n        .then(() => {\r\n          step();\r\n          stepDm();\r\n        });\r\n    } else {\r\n      axios.post(`/message/pin/v1`, {\r\n        token,\r\n        message_id: Number.parseInt(message_id),\r\n      })\r\n        .then(() => {\r\n          step();\r\n          stepDm();\r\n        });\r\n    }\r\n    // Optimistic re-rendering\r\n    // setIsPinned(isPinned => !!!isPinned);\r\n  };\r\n\r\n  return (\r\n    <IconButton\r\n      onClick={toggle}\r\n      style={{ margin: 1 }}\r\n      size=\"small\"\r\n      edge=\"end\"\r\n      aria-label=\"delete\"\r\n    >\r\n      {isPinned ? (\r\n        <MdiIcon\r\n          path={mdiPin}\r\n          size=\"1em\"\r\n          color={theme && theme.palette.action.active}\r\n        />\r\n      ) : (\r\n        <MdiIcon\r\n          path={mdiPinOutline}\r\n          size=\"1em\"\r\n          color={theme && theme.palette.action.active}\r\n        />\r\n      )}\r\n    </IconButton>\r\n  );\r\n}\r\n\r\nexport default withTheme(MessagePin);\r\n","import React from 'react';\r\nimport axios from 'axios';\r\n\r\nimport {\r\n  Badge,\r\n  IconButton,\r\n} from '@material-ui/core';\r\n\r\nimport ThumbUpIcon from '@material-ui/icons/ThumbUp';\r\nimport ThumbUpOutlinedIcon from '@material-ui/icons/ThumbUpOutlined';\r\n\r\nimport AuthContext from '../../AuthContext';\r\nimport { StepContext } from '../Channel/ChannelMessages';\r\nimport { StepContextDm } from '../Dm/DmMessages';\r\n\r\nfunction MessageReact({\r\n  message_id,\r\n  reacts = [] /* [{ react_id, u_ids }] */,\r\n}) {\r\n\r\n  const token = React.useContext(AuthContext);\r\n  let step = React.useContext(StepContext);\r\n  let stepDm = React.useContext(StepContextDm);\r\n  step = step ? step : () => { }; // sanity check\r\n  stepDm = stepDm ? stepDm : () => { }; // sanity check\r\n\r\n  const messageReact = (is_reacted) => {\r\n    if (is_reacted) {\r\n      axios.post(`/message/unreact/v1`, {\r\n        token,\r\n        message_id: Number.parseInt(message_id),\r\n        react_id: 1 /* FIXME */,\r\n      })\r\n        .then(() => {\r\n          step();\r\n          stepDm();\r\n        });\r\n    } else {\r\n      axios.post(`/message/react/v1`, {\r\n        token,\r\n        message_id: Number.parseInt(message_id),\r\n        react_id: 1 /* FIXME */,\r\n      })\r\n        .then(() => {\r\n          step();\r\n          stepDm();\r\n        });\r\n    }\r\n  };\r\n\r\n  let thumbUpCount = 0;\r\n  let is_reacted = false;\r\n  const thumbUpIndex = reacts.findIndex((react) => react.react_id === 1);\r\n  if (thumbUpIndex !== -1) {\r\n    thumbUpCount = reacts[thumbUpIndex].u_ids.length;\r\n    is_reacted = reacts[thumbUpIndex].is_this_user_reacted;\r\n  }\r\n\r\n  return (\r\n    <Badge\r\n      anchorOrigin={{ horizontal: 'right', vertical: 'bottom' }}\r\n      badgeContent={thumbUpCount}\r\n      color=\"secondary\"\r\n    >\r\n      <IconButton\r\n        onClick={() => messageReact(is_reacted)}\r\n        style={{ margin: 1 }}\r\n        size=\"small\"\r\n        edge=\"end\"\r\n        aria-label=\"delete\"\r\n      >\r\n        {is_reacted ? (\r\n          <ThumbUpIcon fontSize=\"small\" />\r\n        ) : (\r\n          <ThumbUpOutlinedIcon fontSize=\"small\" />\r\n        )}\r\n      </IconButton>\r\n    </Badge>\r\n  );\r\n}\r\n\r\nexport default MessageReact;\r\n","import React from 'react';\r\nimport axios from 'axios';\r\n\r\nimport { IconButton } from '@material-ui/core';\r\n\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\n\r\nimport AuthContext from '../../AuthContext';\r\nimport { StepContext } from '../Channel/ChannelMessages';\r\nimport { StepContextDm } from '../Dm/DmMessages';\r\n\r\nfunction MessageRemove({\r\n  message_id,\r\n  disabled = false,\r\n}) {\r\n\r\n  const token = React.useContext(AuthContext);\r\n\r\n  let step = React.useContext(StepContext);\r\n  let stepDm = React.useContext(StepContextDm);\r\n  step = step ? step : () => { }; // sanity check\r\n  stepDm = stepDm ? stepDm : () => { }; // sanity check\r\n\r\n  const messageRemove = () => {\r\n    axios.delete(`/message/remove/v1`, {\r\n      data: {\r\n        token,\r\n        message_id: Number.parseInt(message_id),\r\n      }\r\n    })\r\n      .then(() => {\r\n        step();\r\n        stepDm();\r\n      });\r\n  };\r\n\r\n\r\n  return (\r\n    <IconButton\r\n      disabled={disabled}\r\n      onClick={messageRemove}\r\n      style={{ margin: 1 }}\r\n      size=\"small\"\r\n      edge=\"end\"\r\n      aria-label=\"delete\"\r\n    >\r\n      <DeleteIcon fontSize=\"small\" />\r\n    </IconButton>\r\n  );\r\n}\r\n\r\nexport default MessageRemove;\r\n","import React from 'react';\r\nimport axios from 'axios';\r\n\r\nimport {\r\n    IconButton,\r\n} from '@material-ui/core';\r\n\r\nimport EditIcon from '@material-ui/icons/Edit';\r\n\r\nimport AuthContext from '../../AuthContext';\r\nimport { StepContext } from '../Channel/ChannelMessages';\r\nimport { StepContextDm } from '../Dm/DmMessages';\r\n\r\nfunction MessageEdit({\r\n    message_id,\r\n    disabled = false,\r\n}) {\r\n\r\n    const token = React.useContext(AuthContext);\r\n\r\n    let step = React.useContext(StepContext);\r\n    let stepDm = React.useContext(StepContextDm);\r\n    step = step ? step : () => { }; // sanity check\r\n    stepDm = stepDm ? stepDm : () => { }; // sanity check\r\n\r\n    const messageEdit = () => {\r\n        const message = prompt();\r\n        if (message === null) return; // basic validation\r\n\r\n        /**\r\n         * Empty message should delete original\r\n         */\r\n        if (message === \"\") {\r\n            axios.delete(`/message/remove/v1`, {\r\n                data: {\r\n                    token,\r\n                    message_id: Number.parseInt(message_id),\r\n                }\r\n            })\r\n                .then(() => {\r\n                    step();\r\n                    stepDm();\r\n                });\r\n            return;\r\n        }\r\n\r\n        /**\r\n         * Default message edit behaviour\r\n         */\r\n        axios.put(`/message/edit/v2`, {\r\n            token,\r\n            message_id: Number.parseInt(message_id),\r\n            message,\r\n        })\r\n            .then(() => {\r\n                step();\r\n                stepDm();\r\n            });\r\n    };\r\n\r\n    return (\r\n        <IconButton\r\n            disabled={disabled}\r\n            onClick={messageEdit}\r\n            style={{ margin: 1 }}\r\n            size=\"small\"\r\n            edge=\"end\"\r\n            aria-label=\"delete\"\r\n        >\r\n            <EditIcon fontSize=\"small\" />\r\n        </IconButton>\r\n    );\r\n}\r\n\r\nexport default MessageEdit;\r\n","import React from 'react';\r\nimport axios from 'axios';\r\n\r\nimport {\r\n  Dialog,\r\n  DialogTitle,\r\n  DialogActions,\r\n  DialogContent,\r\n  MenuItem,\r\n  Select,\r\n  DialogContentText,\r\n  Button,\r\n  IconButton,\r\n  TextField,\r\n} from '@material-ui/core';\r\nimport ArrowForwardIcon from '@material-ui/icons/ArrowForward';\r\n\r\nimport AuthContext from '../../AuthContext';\r\nimport { useStep } from '../../utils/update';\r\n\r\nfunction MessageShareDialog({ og_message_id, ...props }) {\r\n  const [open, setOpen] = React.useState(false);\r\n  const [selectedChannel, setSelectedChannel] = React.useState(-1);\r\n  const [selectedDm, setSelectedDm] = React.useState(-1);\r\n  const [selectedChDm, setSelectedChDm] = React.useState('');\r\n  const [channelsShare, setChannelsShare] = React.useState([]);\r\n  const [dmsShare, setDmsShare] = React.useState([]);\r\n  const [message, setMessage] = React.useState('');\r\n\r\n  const token = React.useContext(AuthContext);\r\n\r\n  const step = useStep();\r\n\r\n  function fetchChannelData() {\r\n    axios\r\n      .get('channels/list/v2', {\r\n        params: {\r\n          token,\r\n        },\r\n      })\r\n      .then(({ data }) => {\r\n        setChannelsShare(data['channels']);\r\n      })\r\n      .catch((err) => { });\r\n    axios\r\n      .get('dm/list/v1', {\r\n        params: {\r\n          token,\r\n        },\r\n      })\r\n      .then(({ data }) => {\r\n        setDmsShare(data['dms']);\r\n      })\r\n      .catch((err) => { });\r\n  }\r\n\r\n  React.useEffect(() => {\r\n    fetchChannelData();\r\n  }, []);\r\n\r\n  const handleChannelSelect = event => {\r\n    setSelectedChDm(event.target.value);\r\n    if (event.target.value.slice(0, 1) === 'd') {\r\n      setSelectedDm(event.target.value.slice(1));\r\n      setSelectedChannel(-1);\r\n    } else {\r\n      setSelectedChannel(event.target.value.slice(1));\r\n      setSelectedDm(-1);\r\n    }\r\n  };\r\n\r\n  function handleClickOpen() {\r\n    setOpen(true);\r\n  }\r\n\r\n  function handleClose() {\r\n    setOpen(false);\r\n  }\r\n\r\n  const handleChange = (event) => {\r\n    setMessage(event.target.value);\r\n  };\r\n\r\n  function handleSubmit(event) {\r\n    event.preventDefault();\r\n\r\n    axios.post(`/message/share/v1`, {\r\n      token,\r\n      og_message_id: Number.parseInt(og_message_id),\r\n      message,\r\n      channel_id: Number.parseInt(selectedChannel),\r\n      dm_id: Number.parseInt(selectedDm),\r\n    })\r\n      .then((response) => {\r\n        console.log(response);\r\n        step();\r\n      })\r\n      .catch((err) => { });\r\n  }\r\n  return (\r\n    <div>\r\n      <IconButton\r\n        onClick={handleClickOpen}\r\n        style={{ margin: 1 }}\r\n        size=\"small\"\r\n        edge=\"end\"\r\n        aria-label=\"share\"\r\n      >\r\n        <ArrowForwardIcon fontSize=\"small\" />\r\n      </IconButton>\r\n      <Dialog\r\n        open={open}\r\n        onClose={handleClose}\r\n        aria-labelledby=\"form-dialog-title\"\r\n      >\r\n        <DialogTitle id=\"form-dialog-title\">Share message</DialogTitle>\r\n        <form onSubmit={handleSubmit}>\r\n          <DialogContent>\r\n            <DialogContentText>\r\n              Enter a channel below to share the message to\r\n            </DialogContentText>\r\n            <Select style={{ width: \"100%\" }} id=\"u_id\" onChange={handleChannelSelect} value={selectedChDm}>\r\n              {channelsShare.map((d) => {\r\n                return <MenuItem key={d.channel_id} value={`c${d.channel_id}`}>{d.name}</MenuItem>\r\n              })}\r\n              {dmsShare.map((d) => {\r\n                return <MenuItem key={d.dm_id} value={`d${d.dm_id}`}>{d.name}</MenuItem>\r\n              })}\r\n            </Select>\r\n            <br /><br />\r\n            <DialogContentText>\r\n              Optionally, enter an additional message\r\n            </DialogContentText>\r\n            <TextField\r\n              multiline\r\n              fullWidth\r\n              rowsMax={4}\r\n              value={message}\r\n              onChange={handleChange}\r\n            />\r\n          </DialogContent>\r\n          <DialogActions>\r\n            <Button onClick={handleClose} color=\"primary\">\r\n              Cancel\r\n            </Button>\r\n            <Button onClick={handleClose} type=\"submit\" color=\"primary\">\r\n              Share\r\n            </Button>\r\n          </DialogActions>\r\n        </form>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default MessageShareDialog;\r\n","import React from 'react';\r\nimport timeago from 'epoch-timeago';\r\nimport axios from 'axios';\r\n\r\nimport {\r\n  Avatar,\r\n  ListItem,\r\n  ListItemAvatar,\r\n  ListItemText,\r\n} from '@material-ui/core';\r\n\r\nimport AuthContext from '../../AuthContext';\r\nimport MessagePin from './MessagePin';\r\nimport MessageReact from './MessageReact';\r\nimport MessageRemove from './MessageRemove';\r\nimport MessageEdit from './MessageEdit';\r\nimport MessageShareDialog from './MessageShareDialog';\r\n\r\nimport { isMatchingId } from '../../utils';\r\nimport { extractUId } from '../../utils/token';\r\n\r\nfunction Message({\r\n  message_id,\r\n  message = '',\r\n  u_id,\r\n  time_created,\r\n  is_unread = false,\r\n  is_pinned = false,\r\n  reacts = [] /* [{ react_id, u_ids }] */,\r\n}) {\r\n\r\n  const [nameFirst, setNameFirst] = React.useState();\r\n  const [nameLast, setNameLast] = React.useState();\r\n  const [imgUrl, setImgUrl] = React.useState();\r\n  const token = React.useContext(AuthContext);\r\n  const isUser = isMatchingId(u_id, extractUId(token));\r\n\r\n  const fullName = [nameFirst, nameLast].filter(s => s != null && s !== '').join(' ');\r\n  const initials = [nameFirst, nameLast].filter(s => s != null && s !== '').map(s => s[0]).join('');\r\n  const msgToList = msg => msg.split(\"\\n\");\r\n\r\n  React.useEffect(() => {\r\n    setNameFirst();\r\n    setNameLast();\r\n    setImgUrl()\r\n    axios\r\n      .get(`/user/profile/v2`, {\r\n        params: {\r\n          token,\r\n          u_id,\r\n        },\r\n      })\r\n      .then(({ data }) => {\r\n        const {\r\n          user: {\r\n            email = '',\r\n            name_first = '',\r\n            name_last = '',\r\n            handle_str = '',\r\n            profile_img_url = '',\r\n          },\r\n        } = data;\r\n        setNameFirst(name_first);\r\n        setNameLast(name_last);\r\n        setImgUrl(`${profile_img_url}`);\r\n      })\r\n      .catch((err) => {\r\n        console.error(err);\r\n      });\r\n  }, [message_id, token, u_id]);\r\n\r\n  return (\r\n    <ListItem key={message_id} style={{ width: '100%' }}>\r\n      {message && (\r\n        <>\r\n          <ListItemAvatar>\r\n            <Avatar style={{ width: \"50px\", height: \"50px\", border: \"1px solid #ccc\" }} src={imgUrl}>\r\n              {initials}\r\n            </Avatar>\r\n          </ListItemAvatar>\r\n          <div\r\n            style={{\r\n              display: 'flex',\r\n              width: '100%',\r\n              justifyContent: 'space-between',\r\n              alignItems: 'center',\r\n            }}\r\n          >\r\n            <ListItemText\r\n              primary={\r\n                <>\r\n                  <span>{fullName}</span>\r\n                  <span style={{ paddingLeft: 10, fontSize: 10 }}>\r\n                    {timeago(time_created * 1000)}\r\n                  </span>\r\n                </>\r\n              }\r\n              secondary={\r\n                <div>\r\n                  <pre style={{ fontFamily: 'inherit' }}>{message}</pre>\r\n                </div>\r\n              }\r\n            />\r\n            <div style={{ display: 'flex', height: 30, marginLeft: 20 }}>\r\n              <MessageReact\r\n                message_id={message_id}\r\n                reacts={reacts}\r\n                u_id={u_id}\r\n              />\r\n              <MessagePin\r\n                message_id={message_id}\r\n                is_pinned={is_pinned}\r\n              />\r\n              <MessageShareDialog\r\n                og_message_id={message_id}\r\n              />\r\n              <MessageEdit\r\n                message_id={message_id}\r\n              // disabled={!isUser} /* We have no way of checking admin status */\r\n              />\r\n              <MessageRemove\r\n                message_id={message_id}\r\n              // disabled={!isUser} /* We have no way of checking admin status */\r\n              />\r\n            </div>\r\n          </div>\r\n        </>\r\n      )}\r\n    </ListItem>\r\n  );\r\n}\r\n\r\nexport default Message;\r\n","import React from 'react';\r\nimport axios from 'axios';\r\n\r\nimport { List, ListSubheader, Button, ListItem } from '@material-ui/core';\r\nimport { useStep } from '../../utils/update';\r\nimport Message from '../Message';\r\nimport AuthContext from '../../AuthContext';\r\nimport AddMessage from '../Message/AddMessage';\r\nimport { PAGINATION_SIZE, SLICE_SIZE } from '../../utils/constants';\r\n\r\n\r\nexport const StepContext = React.createContext();\r\nexport const StepProvider = StepContext.Provider;\r\nexport const StepConsumer = StepContext.Consumer;\r\n\r\nfunction ChannelMessages({ channel_id = '' }) {\r\n\r\n  const [messages, setMessages] = React.useState([]);\r\n  const [pagination, setPagination] = React.useState({\r\n    \"channelId\": channel_id,\r\n    \"isPaginating\": false,\r\n    \"currentStart\": 0,\r\n    \"currentEnd\": 0,\r\n    \"sliceStart\": 0,\r\n  })\r\n  const token = React.useContext(AuthContext);\r\n\r\n  const fetchChannelMessages = () => {\r\n    const p = pagination.channelId === channel_id\r\n      ? pagination\r\n      : {\r\n        \"channelId\": channel_id,\r\n        \"isPaginating\": false,\r\n        \"currentStart\": 0,\r\n        \"currentEnd\": 0,\r\n        \"sliceStart\": 0,\r\n      }\r\n    axios\r\n      .get('/channel/messages/v2', {\r\n        params: {\r\n          token,\r\n          channel_id: Number.parseInt(channel_id),\r\n          start: p.isPaginating ? p.currentStart : 0,\r\n        },\r\n      })\r\n      .then(({ data }) => {\r\n        const { messages: newMessages, start, end } = data;\r\n        setPagination({ ...p, channelId: channel_id, currentEnd: end }); // TODO: add/remove problems\r\n        setMessages(newMessages);\r\n      })\r\n      .catch((err) => { });\r\n  }\r\n  useStep(fetchChannelMessages, [channel_id, pagination.currentStart]);\r\n\r\n  const onPrev = () => setPagination(({ sliceStart, currentStart, currentEnd, ...pagination }) => {\r\n\r\n    const pageSize = messages.length;\r\n\r\n    if (sliceStart + SLICE_SIZE < pageSize) {\r\n      return {\r\n        ...pagination,\r\n        currentStart,\r\n        currentEnd,\r\n        sliceStart: sliceStart + SLICE_SIZE,\r\n        isPaginating: true,\r\n      };\r\n    }\r\n\r\n    return {\r\n      ...pagination,\r\n      currentEnd,\r\n      currentStart: currentEnd,\r\n      sliceStart: 0,\r\n      isPaginating: true,\r\n    };\r\n\r\n  });\r\n\r\n  const onNext = () => setPagination(({ sliceStart, currentStart, ...pagination }) => {\r\n\r\n    if (sliceStart >= SLICE_SIZE) {\r\n      return {\r\n        ...pagination,\r\n        currentStart,\r\n        sliceStart: sliceStart - SLICE_SIZE,\r\n        isPaginating: !(currentStart == 0 && sliceStart == SLICE_SIZE)\r\n      };\r\n    }\r\n\r\n    if (currentStart >= PAGINATION_SIZE) {\r\n      if (currentStart) return {\r\n        ...pagination,\r\n        currentStart: currentStart - PAGINATION_SIZE,\r\n        sliceStart: PAGINATION_SIZE - SLICE_SIZE,\r\n      };\r\n    }\r\n\r\n    return {\r\n      ...pagination,\r\n      currentStart: 0,\r\n      sliceStart: 0,\r\n      isPaginating: false,\r\n    };\r\n\r\n  });\r\n\r\n  const { currentStart, currentEnd, sliceStart, isPaginating } = pagination;\r\n\r\n  const isEnd = currentEnd == -1 && sliceStart >= messages.length - SLICE_SIZE;\r\n\r\n  const pinnedMessages = messages.filter(m => m.is_pinned);\r\n  const subheader = !messages.length\r\n    ? `Messages (None)`\r\n    : `Messages [${currentStart + sliceStart + 1}...${Math.min(currentStart + messages.length, currentStart + sliceStart + SLICE_SIZE)}]`;\r\n\r\n  return (\r\n    <StepProvider value={fetchChannelMessages}>\r\n      {pinnedMessages.length > 0 && <>\r\n        <hr />\r\n        <List subheader={<ListSubheader>Pinned Messages</ListSubheader>}>\r\n          {pinnedMessages.map(m => <Message key={m.message_id} {...m} />)}\r\n        </List>\r\n      </>}\r\n      <hr />\r\n      <List\r\n        subheader={<ListSubheader>{subheader}</ListSubheader>}\r\n        style={{ width: '100%' }}\r\n      >\r\n        {\r\n          (!isEnd &&\r\n            <ListItem>\r\n              <Button\r\n                variant=\"outlined\"\r\n                color=\"secondary\"\r\n                onClick={onPrev}\r\n              >\r\n                Previous messages\r\n              </Button>\r\n            </ListItem>\r\n          )\r\n        }\r\n        {messages.slice(sliceStart, sliceStart + SLICE_SIZE).reverse().map((message) => (\r\n          <Message key={message.message_id} {...message} />\r\n        ))}\r\n        {\r\n          (isPaginating &&\r\n            <ListItem>\r\n              <Button\r\n                variant=\"outlined\"\r\n                color=\"secondary\"\r\n                onClick={onNext}\r\n              >\r\n                Next messages\r\n              </Button>\r\n            </ListItem>\r\n          )\r\n        }\r\n      </List>\r\n      <AddMessage channel_id={channel_id} />\r\n    </StepProvider>\r\n  );\r\n}\r\n\r\nexport default ChannelMessages;\r\n","import {CircularProgress} from \"@material-ui/core\";\r\nimport React from \"react\";\r\n\r\nfunction Placeholder() {\r\n    return <div style={{\r\n        display: \"flex\",\r\n        width: \"100%\",\r\n        height: \"100%\",\r\n        justifyContent: \"center\",\r\n        alignItems: \"center\"\r\n    }}>\r\n        <CircularProgress />\r\n    </div>;\r\n}\r\n\r\nexport default Placeholder;\r\n","import {\r\n  Avatar,\r\n  List,\r\n  ListItem,\r\n  ListItemAvatar,\r\n  ListItemText,\r\n  ListSubheader,\r\n  Typography,\r\n  Button,\r\n  Grid,\r\n  Link,\r\n  IconButton\r\n} from '@material-ui/core';\r\nimport PersonAdd from '@material-ui/icons/PersonAdd';\r\nimport PersonAddDisabled from '@material-ui/icons/PersonAddDisabled';\r\nimport axios from 'axios';\r\nimport React from 'react';\r\nimport AddMemberDialog from './AddMemberDialog';\r\nimport ChannelMessages from './ChannelMessages';\r\nimport AuthContext from '../../AuthContext';\r\nimport { extractUId } from '../../utils/token';\r\nimport { isMatchingId } from '../../utils';\r\nimport { useStep } from '../../utils/update';\r\nimport Placeholder from '../Placeholder';\r\n\r\nfunction Channel({ channel_id, ...props }) {\r\n  const [loading, setLoading] = React.useState(true);\r\n  const [name, setName] = React.useState('');\r\n  const [members, setMembers] = React.useState([]);\r\n  const [owners, setOwners] = React.useState([]);\r\n  const token = React.useContext(AuthContext);\r\n  const u_id = extractUId(token);\r\n\r\n  function fetchChannelData() {\r\n    axios\r\n      .get('/channel/details/v2', {\r\n        params: {\r\n          token,\r\n          channel_id: channel_id,\r\n        },\r\n      })\r\n      .then(({ data }) => {\r\n        const { name, owner_members, all_members } = data;\r\n        // assumes members of form [{ u_id, name_first, name_last }]\r\n        setMembers(all_members);\r\n        setOwners(owner_members);\r\n        setName(name);\r\n      })\r\n      .catch((err) => {\r\n        setMembers([]);\r\n        setOwners([]);\r\n        setName('');\r\n      })\r\n      .finally(() => setLoading(false));\r\n  }\r\n\r\n  useStep(fetchChannelData, [channel_id, token], 2);\r\n\r\n  function joinChannel(channel_id, token) {\r\n    axios\r\n      .post('/channel/join/v2', {\r\n        token,\r\n        channel_id: Number.parseInt(channel_id),\r\n      })\r\n      .then(() => {\r\n        fetchChannelData(channel_id, token);\r\n      })\r\n      .catch((err) => { });\r\n  }\r\n\r\n  function leaveChannel(channel_id, token) {\r\n    axios\r\n      .post('/channel/leave/v1', {\r\n        token,\r\n        channel_id: Number.parseInt(channel_id),\r\n      })\r\n      .then(() => {\r\n        fetchChannelData(channel_id, token);\r\n      })\r\n      .catch((err) => { });\r\n  }\r\n\r\n  function addOwner(u_id) {\r\n    axios\r\n      .post('/channel/addowner/v1', {\r\n        token,\r\n        channel_id: Number.parseInt(channel_id),\r\n        u_id: Number.parseInt(u_id),\r\n      })\r\n      .then(() => {\r\n        fetchChannelData(channel_id, token);\r\n      })\r\n      .catch((err) => { });\r\n  }\r\n\r\n  function removeOwner(u_id) {\r\n    axios\r\n      .post('/channel/removeowner/v1', {\r\n        token,\r\n        channel_id: Number.parseInt(channel_id),\r\n        u_id: Number.parseInt(u_id),\r\n      })\r\n      .then(() => {\r\n        fetchChannelData(channel_id, token);\r\n      })\r\n      .catch((err) => { });\r\n  }\r\n\r\n  function userIsMember(members) {\r\n    return members.find((member) => isMatchingId(member.u_id, u_id)) !== undefined;\r\n  }\r\n\r\n  function userIsOwner(owners, u_id) {\r\n    return owners.find((owner) => isMatchingId(owner.u_id, u_id)) !== undefined;\r\n  }\r\n\r\n  const viewerIsOwner = userIsOwner(owners, u_id);\r\n  const viewerIsMember = userIsMember(members);\r\n\r\n  return <>\r\n    {loading\r\n      ? <Placeholder />\r\n      : <>\r\n        <Typography variant=\"h4\">{name.toUpperCase()}</Typography>\r\n        <List subheader={<ListSubheader>Members</ListSubheader>}>\r\n          {members.map(({ u_id, name_first, name_last, profile_img_url }) => (\r\n            <ListItem key={u_id}>\r\n              <ListItemAvatar>\r\n                <Avatar style={{ width: \"50px\", height: \"50px\", border: \"1px solid #ccc\" }} src={profile_img_url}>\r\n                  {[name_first, name_last].filter(s => s != null && s !== '').map(s => s[0]).join('')}\r\n                </Avatar>\r\n              </ListItemAvatar>\r\n              <ListItemText\r\n                primary={\r\n                  <>\r\n                    <Grid container alignItems=\"center\" spacing={1}>\r\n                      <Grid item>\r\n                        <Link\r\n                          href={`/profile/${u_id}`}\r\n                        >{`${name_first} ${name_last}`}</Link>\r\n                        {`${userIsOwner(owners, u_id) ? ' ' : ' '}`}\r\n                      </Grid>\r\n                      {viewerIsOwner && (\r\n                        <Grid item>\r\n                          {userIsOwner(owners, u_id) ? (\r\n                            <IconButton\r\n                              size=\"small\"\r\n                              onClick={() => removeOwner(u_id)}\r\n                            >\r\n                              <PersonAddDisabled />\r\n                            </IconButton>\r\n                          ) : (\r\n                            <IconButton\r\n                              size=\"small\"\r\n                              onClick={() => addOwner(u_id)}\r\n                            >\r\n                              <PersonAdd />\r\n                            </IconButton>\r\n                          )}\r\n                        </Grid>\r\n                      )}\r\n                    </Grid>\r\n                  </>\r\n                }\r\n              />\r\n            </ListItem>\r\n          ))}\r\n          <ListItem key=\"invite_member\">\r\n            {userIsMember(members) ? (\r\n              <Grid container spacing={1}>\r\n                <Grid item>\r\n                  <AddMemberDialog channel_id={channel_id} />\r\n                </Grid>\r\n                <Grid item>\r\n                  <Button\r\n                    variant=\"outlined\"\r\n                    onClick={() => leaveChannel(channel_id, token)}\r\n                  >\r\n                    Leave Channel\r\n                          </Button>\r\n                </Grid>\r\n              </Grid>\r\n            ) : (\r\n              <Button\r\n                variant=\"outlined\"\r\n                color=\"primary\"\r\n                onClick={() => joinChannel(channel_id, token)}\r\n              >\r\n                Join Channel\r\n              </Button>\r\n            )}\r\n          </ListItem>\r\n        </List>\r\n        {viewerIsMember && <ChannelMessages channel_id={channel_id} />}\r\n      </>\r\n    }\r\n  </>;\r\n}\r\n\r\nexport default Channel;\r\n","import React from 'react';\r\nimport Layout from '../components/Layout';\r\nimport ProfileChannelLists from '../components/ProfileChannelLists';\r\nimport Channel from '../components/Channel';\r\n\r\nfunction ChannelPage({ match }) {\r\n  const { channel_id } = match.params;\r\n  return (\r\n    <Layout\r\n      menu={<ProfileChannelLists channel_id={channel_id} dm_id={null} />}\r\n      body={<Channel channel_id={channel_id} />}\r\n    />\r\n  );\r\n}\r\n\r\nexport default ChannelPage;\r\n","import React from 'react';\r\nimport axios from 'axios';\r\n\r\nimport {\r\n  Dialog,\r\n  DialogTitle,\r\n  DialogActions,\r\n  DialogContent,\r\n  MenuItem,\r\n  Select,\r\n  DialogContentText,\r\n  Button,\r\n} from '@material-ui/core';\r\nimport AuthContext from '../../AuthContext';\r\nimport { useStep } from '../../utils/update';\r\n\r\nfunction AddDmMemberDialog({ dm_id, ...props }) {\r\n  const [open, setOpen] = React.useState(false);\r\n  const [selectedUser, setSelectedUser] = React.useState('');\r\n  const [users, setUsers] = React.useState([]);\r\n\r\n  const token = React.useContext(AuthContext);\r\n\r\n  const step = useStep();\r\n\r\n\r\n  function fetchUserData() {\r\n    axios\r\n      .get('/users/all/v1', {\r\n        params: {\r\n          token,\r\n        },\r\n      })\r\n      .then(({ data }) => {\r\n        setUsers(data['users']);\r\n      })\r\n      .catch((err) => { });\r\n  }\r\n\r\n  React.useEffect(() => {\r\n    fetchUserData();\r\n  }, []);\r\n\r\n  const handleUserSelect = event => {\r\n    const newUserId = parseInt(event.target.value, 10);\r\n    setSelectedUser(newUserId);\r\n  };\r\n\r\n  function handleClickOpen() {\r\n    setOpen(true);\r\n  }\r\n  function handleClose() {\r\n    setOpen(false);\r\n  }\r\n  function handleSubmit(event) {\r\n    event.preventDefault();\r\n    const u_id = selectedUser;\r\n\r\n    if (u_id == null) return;\r\n\r\n    axios.post(`/dm/invite/v1`, {\r\n      token,\r\n      u_id: Number.parseInt(u_id),\r\n      dm_id: Number.parseInt(dm_id),\r\n    })\r\n      .then((response) => {\r\n        console.log(response);\r\n        step();\r\n      })\r\n      .catch((err) => { });\r\n  }\r\n  return (\r\n    <div>\r\n      <Button variant=\"outlined\" color=\"primary\" onClick={handleClickOpen}>\r\n        Invite Member\r\n      </Button>\r\n      <Dialog\r\n        open={open}\r\n        onClose={handleClose}\r\n        aria-labelledby=\"form-dialog-title\"\r\n      >\r\n        <DialogTitle id=\"form-dialog-title\">Invite User</DialogTitle>\r\n        <form onSubmit={handleSubmit}>\r\n          <DialogContent>\r\n            <DialogContentText>\r\n              Select a user below to invite them to this DM\r\n            </DialogContentText>\r\n            <Select style={{ width: \"100%\" }} id=\"u_id\" onChange={handleUserSelect} value={selectedUser}>\r\n              {users.map((d, idx) => {\r\n                return <MenuItem key={d.u_id} value={d.u_id}>{d.name_first} {d.name_last}</MenuItem>\r\n              })}\r\n            </Select>\r\n          </DialogContent>\r\n          <DialogActions>\r\n            <Button onClick={handleClose} color=\"primary\">\r\n              Cancel\r\n            </Button>\r\n            <Button onClick={handleClose} type=\"submit\" color=\"primary\">\r\n              Invite\r\n            </Button>\r\n          </DialogActions>\r\n        </form>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default AddDmMemberDialog;\r\n","import {\r\n  Avatar,\r\n  List,\r\n  ListItem,\r\n  ListItemAvatar,\r\n  ListItemText,\r\n  ListSubheader,\r\n  Typography,\r\n  Button,\r\n  Grid,\r\n  Link,\r\n} from '@material-ui/core';\r\nimport axios from 'axios';\r\nimport React from 'react';\r\nimport AddDmMemberDialog from './AddDmMemberDialog';\r\nimport DmMessages from './DmMessages';\r\nimport AuthContext from '../../AuthContext';\r\nimport { useStep } from '../../utils/update';\r\nimport Placeholder from '../Placeholder';\r\n\r\nfunction Dm({ dm_id, ...props }) {\r\n  const [loading, setLoading] = React.useState(true);\r\n  const [name, setName] = React.useState('');\r\n  const [membersList, setMembersList] = React.useState([]);\r\n  const token = React.useContext(AuthContext);\r\n\r\n  function fetchDmData() {\r\n    axios\r\n      .get('/dm/details/v1', {\r\n        params: {\r\n          token,\r\n          dm_id: dm_id,\r\n        },\r\n      })\r\n      .then(({ data }) => {\r\n        const { name, members } = data;\r\n        // assumes members of form [{ u_id, name_first, name_last }]\r\n        console.log(members);\r\n        setMembersList(members);\r\n        setName(name);\r\n      })\r\n      .catch((err) => {\r\n        setMembersList([]);\r\n        setName('');\r\n      })\r\n      .finally(() => setLoading(false));\r\n  }\r\n\r\n  useStep(fetchDmData, [dm_id, token], 2);\r\n\r\n  function leaveDm(dm_id, token) {\r\n    axios\r\n      .post('/dm/leave/v1', {\r\n        token,\r\n        dm_id: Number.parseInt(dm_id),\r\n      })\r\n      .then(() => {\r\n        fetchDmData(dm_id, token);\r\n      })\r\n      .catch((err) => { });\r\n  }\r\n\r\n  function removeDm(dm_id, token) {\r\n    axios.delete(`/dm/remove/v1`, {\r\n      data: {\r\n        token,\r\n        dm_id: Number.parseInt(dm_id),\r\n      }\r\n    })\r\n      .then(() => {\r\n        fetchDmData(dm_id, token);\r\n      })\r\n      .catch((err) => { });\r\n  }\r\n\r\n  return <>\r\n    {loading\r\n      ? <Placeholder />\r\n      : <>\r\n        <Typography variant=\"h4\">{name.toUpperCase()}</Typography>\r\n        <List subheader={<ListSubheader>Members</ListSubheader>}>\r\n          {membersList.map(({ u_id, name_first, name_last, profile_img_url }) => (\r\n            <ListItem key={u_id}>\r\n              <ListItemAvatar>\r\n                <Avatar style={{ width: \"50px\", height: \"50px\", border: \"1px solid #ccc\" }} src={profile_img_url}>\r\n                  {[name_first, name_last].filter(s => s != null && s !== '').map(s => s[0]).join('')}\r\n                </Avatar>\r\n              </ListItemAvatar>\r\n              <ListItemText\r\n                primary={\r\n                  <>\r\n                    <Grid container alignItems=\"center\" spacing={1}>\r\n                      <Grid item>\r\n                        <Link\r\n                          href={`/profile/${u_id}`}\r\n                        >{`${name_first} ${name_last}`}</Link>\r\n                      </Grid>\r\n                    </Grid>\r\n                  </>\r\n                }\r\n              />\r\n            </ListItem>\r\n          ))}\r\n          <ListItem key=\"leave_dm\">\r\n            <Grid container spacing={1}>\r\n              <Grid item>\r\n                <AddDmMemberDialog dm_id={dm_id} />\r\n              </Grid>\r\n              <Grid item>\r\n                <Button\r\n                  variant=\"outlined\"\r\n                  onClick={() => leaveDm(dm_id, token)}\r\n                >\r\n                  Leave Dm\r\n                </Button>\r\n                &nbsp;\r\n                <Button\r\n                  variant=\"outlined\"\r\n                  onClick={() => removeDm(dm_id, token)}\r\n                >\r\n                  Remove Dm\r\n                </Button>\r\n              </Grid>\r\n            </Grid>\r\n          </ListItem>\r\n        </List>\r\n        <DmMessages dm_id={dm_id} />\r\n      </>\r\n    }\r\n  </>;\r\n}\r\n\r\nexport default Dm;\r\n","import React from 'react';\r\nimport Layout from '../components/Layout';\r\nimport ProfileChannelLists from '../components/ProfileChannelLists';\r\nimport Dm from '../components/Dm';\r\n\r\nfunction DmPage({ match }) {\r\n  const { dm_id } = match.params;\r\n  return (\r\n    <Layout\r\n      menu={<ProfileChannelLists channel_id={null} dm_id={dm_id} />}\r\n      body={<Dm dm_id={dm_id} />}\r\n    />\r\n  );\r\n}\r\n\r\nexport default DmPage;\r\n","import axios from 'axios';\r\nimport {\r\n  Avatar,\r\n  Box,\r\n  Button,\r\n  Container,\r\n  Grid,\r\n  Link,\r\n  makeStyles,\r\n  TextField,\r\n  Typography,\r\n} from '@material-ui/core';\r\nimport LockOutlinedIcon from '@material-ui/icons/LockOutlined';\r\nimport React from 'react';\r\nimport '../App.css';\r\nimport Placeholder from '../components/Placeholder';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  '@global': {\r\n    body: {\r\n      backgroundColor: theme.palette.primary.light,\r\n    },\r\n  },\r\n  card: {\r\n    backgroundColor: theme.palette.background.paper,\r\n    marginTop: theme.spacing(8),\r\n    padding: theme.spacing(8),\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n    borderRadius: theme.shape.borderRadius,\r\n  },\r\n}));\r\n\r\nfunction LoginPage({ setAuth, ...props }) {\r\n\r\n  const [loading, setLoading] = React.useState(false);\r\n\r\n  function handleSubmit(event) {\r\n    event.preventDefault();\r\n\r\n    // Get user inputs (TODO:)\r\n    const email = event.target[0].value;\r\n    const password = event.target[2].value;\r\n\r\n    // Quick validation\r\n    if (!email || !password) return;\r\n\r\n    setLoading(true);\r\n\r\n    // Send to backend\r\n    axios.post(`/auth/login/v2`, { email, password })\r\n      .then((response) => {\r\n        console.log(response);\r\n        const data = response.data;\r\n        setAuth(data.token, data.auth_user_id);\r\n        props.history.push('/');\r\n      })\r\n      .catch((err) => { })\r\n      .finally(() => setLoading(false));\r\n  }\r\n\r\n  const classes = useStyles();\r\n\r\n  return (\r\n    <Container component=\"main\" maxWidth=\"sm\">\r\n      <Box boxShadow={3} className={classes.card}>\r\n        <Avatar>\r\n          <LockOutlinedIcon />\r\n        </Avatar>\r\n        <Typography component=\"h1\" variant=\"h5\">\r\n          Login\r\n        </Typography>\r\n        {\r\n          loading\r\n            ? <div style={{ marginTop: \"64px\" }}><Placeholder /></div>\r\n            : <form noValidate onSubmit={handleSubmit}>\r\n              <TextField\r\n                variant=\"outlined\"\r\n                margin=\"normal\"\r\n                required\r\n                fullWidth\r\n                id=\"email\"\r\n                label=\"Email\"\r\n                name=\"email\"\r\n                type=\"text\"\r\n                autoFocus\r\n              />\r\n              <TextField\r\n                variant=\"outlined\"\r\n                margin=\"normal\"\r\n                required\r\n                fullWidth\r\n                name=\"password\"\r\n                label=\"Password\"\r\n                type=\"password\"\r\n                id=\"password\"\r\n                autoComplete=\"current-password\"\r\n              />\r\n              <div className=\"password-warning\">\r\n                Passwords are not securely stored.<br />\r\n                  Do not enter any currently used passwords.<br />\r\n                For DEMO:<br />\r\n                email: demo_user1@email.com password: demo_user1<br />\r\n                email: demo_user2@email.com password: demo_user2\r\n                </div>\r\n              <Button type=\"submit\" fullWidth variant=\"contained\" color=\"primary\">\r\n                Sign In\r\n                </Button>\r\n              <Grid container direction=\"column\" alignItems=\"center\">\r\n                <Grid item>\r\n                  <br />\r\n                  <Link href=\"/register\" variant=\"body1\">\r\n                    {\"Don't have an account? Register\"}\r\n                  </Link>\r\n                </Grid>\r\n                <Grid item>\r\n                  <br />\r\n                  <Link href=\"/forgot_password\" variant=\"body1\">\r\n                    Forgot password?\r\n                    </Link>\r\n                </Grid>\r\n              </Grid>\r\n            </form>\r\n        }\r\n      </Box>\r\n    </Container>\r\n  );\r\n}\r\n\r\nexport default LoginPage;\r\n","import axios from 'axios';\r\nimport {\r\n  Avatar,\r\n  Box,\r\n  Button,\r\n  Container,\r\n  Grid,\r\n  Link,\r\n  makeStyles,\r\n  TextField,\r\n  Typography,\r\n} from '@material-ui/core';\r\nimport DeveloperOutlinedIcon from '@material-ui/icons/DeveloperModeOutlined';\r\nimport React from 'react';\r\nimport Placeholder from '../components/Placeholder';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  '@global': {\r\n    body: {\r\n      backgroundColor: theme.palette.primary.light,\r\n    },\r\n  },\r\n  card: {\r\n    backgroundColor: theme.palette.background.paper,\r\n    marginTop: theme.spacing(8),\r\n    padding: theme.spacing(8),\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n    borderRadius: theme.shape.borderRadius,\r\n  },\r\n}));\r\n\r\nfunction RegisterPage({ setAuth, ...props }) {\r\n\r\n  const [loading, setLoading] = React.useState(false);\r\n  const [values, setValues] = React.useState({\r\n    name_first: '',\r\n    name_last: '',\r\n    email: '',\r\n    password: '',\r\n  });\r\n\r\n  const handleChange = name => event => {\r\n    setValues({ ...values, [name]: event.target.value });\r\n  };\r\n\r\n  function handleSubmit(event) {\r\n    event.preventDefault();\r\n\r\n    // Quick validation\r\n    if (!values.email || !values.password) return;\r\n\r\n    setLoading(true);\r\n\r\n    // Send to backend\r\n    axios.post(`/auth/register/v2`, { ...values })\r\n      .then((response) => {\r\n        console.log(response);\r\n        const data = response.data;\r\n        setAuth(data.token, data.auth_user_id);\r\n        props.history.push('/');\r\n      })\r\n      .catch((err) => { })\r\n      .finally(() => setLoading(false));\r\n  }\r\n\r\n  const classes = useStyles();\r\n\r\n  return (\r\n    <Container component=\"main\" maxWidth=\"sm\">\r\n      <Box boxShadow={3} className={classes.card}>\r\n        <Avatar>\r\n          <DeveloperOutlinedIcon color=\"secondary\" />\r\n        </Avatar>\r\n        <Typography component=\"h1\" variant=\"h5\">\r\n          Register\r\n        </Typography>\r\n        {loading\r\n          ? <div style={{ marginTop: \"64px\" }}><Placeholder /></div>\r\n          : <form noValidate onSubmit={handleSubmit}>\r\n            <TextField\r\n              variant=\"outlined\"\r\n              margin=\"normal\"\r\n              required\r\n              fullWidth\r\n              id=\"name_first\"\r\n              label=\"First name\"\r\n              name=\"name_first\"\r\n              type=\"text\"\r\n              autoFocus\r\n              value={values.name_first}\r\n              onChange={handleChange('name_first')}\r\n            />\r\n            <TextField\r\n              variant=\"outlined\"\r\n              margin=\"normal\"\r\n              required\r\n              fullWidth\r\n              id=\"name_last\"\r\n              label=\"Last name\"\r\n              name=\"name_last\"\r\n              type=\"text\"\r\n              value={values.name_last}\r\n              onChange={handleChange('name_last')}\r\n            />\r\n            <TextField\r\n              variant=\"outlined\"\r\n              margin=\"normal\"\r\n              required\r\n              fullWidth\r\n              id=\"email\"\r\n              label=\"Email\"\r\n              name=\"email\"\r\n              type=\"email\"\r\n              value={values.email}\r\n              onChange={handleChange('email')}\r\n            />\r\n            <TextField\r\n              variant=\"outlined\"\r\n              margin=\"normal\"\r\n              required\r\n              fullWidth\r\n              name=\"password\"\r\n              label=\"Password\"\r\n              type=\"password\"\r\n              id=\"password\"\r\n              autoComplete=\"current-password\"\r\n              value={values.password}\r\n              onChange={handleChange('password')}\r\n            />\r\n            <div className=\"password-warning\">\r\n              Passwords are not securely stored.<br />\r\n                Do not enter any currently used passwords.<br />\r\n              For DEMO:<br />\r\n              email: demo_user1@email.com password: demo_user1<br />\r\n              email: demo_user2@email.com password: demo_user2\r\n                </div>\r\n            <Button type=\"submit\" fullWidth variant=\"contained\" color=\"primary\">\r\n              Sign Up\r\n                </Button>\r\n            <Grid container>\r\n              <Grid item>\r\n                <br />\r\n                <Link href=\"/login\" variant=\"body1\">\r\n                  {'Already have an account? Login'}\r\n                </Link>\r\n              </Grid>\r\n            </Grid>\r\n          </form>\r\n        }\r\n      </Box>\r\n    </Container>\r\n  );\r\n}\r\n\r\nexport default RegisterPage;\r\n","import axios from 'axios';\r\nimport {\r\n  Avatar,\r\n  Box,\r\n  Button,\r\n  Container,\r\n  Grid,\r\n  Link,\r\n  makeStyles,\r\n  TextField,\r\n  Typography,\r\n} from '@material-ui/core';\r\nimport DeveloperOutlinedIcon from '@material-ui/icons/DeveloperModeOutlined';\r\nimport React from 'react';\r\nimport Placeholder from \"../components/Placeholder\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  '@global': {\r\n    body: {\r\n      backgroundColor: theme.palette.primary.light,\r\n    },\r\n  },\r\n  card: {\r\n    backgroundColor: theme.palette.background.paper,\r\n    marginTop: theme.spacing(8),\r\n    padding: theme.spacing(8),\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n    borderRadius: theme.shape.borderRadius,\r\n  },\r\n}));\r\n\r\nfunction ForgotPasswordPage(props) {\r\n  const [loading, setLoading] = React.useState(false);\r\n\r\n  function handleSubmit(event) {\r\n    event.preventDefault();\r\n\r\n    // Get user inputs (TODO:)\r\n    const email = event.target[0].value;\r\n\r\n    // Quick validation\r\n    if (!email) return;\r\n\r\n    setLoading(true);\r\n\r\n    // Send to backend\r\n    axios.post(`/auth/passwordreset/request/v1`, { email })\r\n      .then((response) => {\r\n        console.log(response);\r\n        props.history.push('/reset_password');\r\n      })\r\n      .catch((err) => { })\r\n      .finally(() => setLoading(false));\r\n  }\r\n\r\n  const classes = useStyles();\r\n\r\n  return (\r\n    <Container component=\"main\" maxWidth=\"sm\">\r\n      <Box boxShadow={3} className={classes.card}>\r\n        <Avatar>\r\n          <DeveloperOutlinedIcon color=\"secondary\" />\r\n        </Avatar>\r\n        <Typography component=\"h1\" variant=\"h5\">\r\n          Forgot Password\r\n        </Typography>\r\n        {\r\n          loading\r\n            ? <div style={{ marginTop: \"64px\" }}><Placeholder /></div>\r\n            : <form noValidate onSubmit={handleSubmit}>\r\n              <TextField\r\n                variant=\"outlined\"\r\n                margin=\"normal\"\r\n                required\r\n                fullWidth\r\n                id=\"email\"\r\n                label=\"Email\"\r\n                name=\"email\"\r\n                type=\"email\"\r\n                autoFocus\r\n              />\r\n              <Button type=\"submit\" fullWidth variant=\"contained\" color=\"primary\">\r\n                Send Recovery Email\r\n                </Button>\r\n              <Grid container>\r\n                <Grid item>\r\n                  <br />\r\n                  <Link href=\"/login\" variant=\"body1\">\r\n                    {'Remember your password? Login'}\r\n                  </Link>\r\n                </Grid>\r\n              </Grid>\r\n            </form>\r\n        }\r\n      </Box>\r\n    </Container>\r\n  );\r\n}\r\n\r\nexport default ForgotPasswordPage;\r\n","import axios from 'axios';\r\nimport {\r\n  Avatar,\r\n  Box,\r\n  Button,\r\n  Container,\r\n  Grid,\r\n  Link,\r\n  makeStyles,\r\n  TextField,\r\n  Typography,\r\n} from '@material-ui/core';\r\nimport DeveloperOutlinedIcon from '@material-ui/icons/DeveloperModeOutlined';\r\nimport React from 'react';\r\nimport Placeholder from \"../components/Placeholder\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  '@global': {\r\n    body: {\r\n      backgroundColor: theme.palette.primary.light,\r\n    },\r\n  },\r\n  card: {\r\n    backgroundColor: theme.palette.background.paper,\r\n    marginTop: theme.spacing(8),\r\n    padding: theme.spacing(8),\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n    borderRadius: theme.shape.borderRadius,\r\n  },\r\n}));\r\n\r\nfunction ForgotPasswordPage(props) {\r\n  const [loading, setLoading] = React.useState(false);\r\n\r\n  function handleSubmit(event) {\r\n    event.preventDefault();\r\n\r\n    // Get user inputs (TODO:)\r\n    const reset_code = event.target[0].value;\r\n    const new_password = event.target[2].value;\r\n\r\n    // Quick validation\r\n    if (!reset_code || !new_password) return;\r\n\r\n    setLoading(true);\r\n\r\n    // Send to backend\r\n    axios.post(`/auth/passwordreset/reset/v1`, { reset_code, new_password })\r\n      .then((response) => {\r\n        console.log(response);\r\n        props.history.push('/login');\r\n      })\r\n      .catch((err) => { })\r\n      .finally(() => setLoading(false));\r\n  }\r\n\r\n  const classes = useStyles();\r\n\r\n  return (\r\n    <Container component=\"main\" maxWidth=\"sm\">\r\n      <Box boxShadow={3} className={classes.card}>\r\n        <Avatar>\r\n          <DeveloperOutlinedIcon color=\"secondary\" />\r\n        </Avatar>\r\n        <Typography component=\"h1\" variant=\"h5\">\r\n          Reset Password\r\n        </Typography>\r\n        {\r\n          loading\r\n            ? <div style={{ marginTop: \"64px\" }}><Placeholder /></div>\r\n            : <form noValidate onSubmit={handleSubmit}>\r\n              <TextField\r\n                variant=\"outlined\"\r\n                margin=\"normal\"\r\n                required\r\n                fullWidth\r\n                id=\"reset_code\"\r\n                label=\"Reset code\"\r\n                name=\"reset_code\"\r\n                type=\"text\"\r\n                autoFocus\r\n              />\r\n              <TextField\r\n                variant=\"outlined\"\r\n                margin=\"normal\"\r\n                required\r\n                fullWidth\r\n                id=\"new_password\"\r\n                label=\"New Password\"\r\n                name=\"new_password\"\r\n                type=\"password\"\r\n              />\r\n              <Button type=\"submit\" fullWidth variant=\"contained\" color=\"primary\">\r\n                Change Password\r\n                </Button>\r\n              <Grid container>\r\n                <Grid item>\r\n                  <br />\r\n                  <Link href=\"/login\" variant=\"body1\">\r\n                    {'Remember your password? Login'}\r\n                  </Link>\r\n                </Grid>\r\n              </Grid>\r\n            </form>\r\n        }\r\n      </Box>\r\n    </Container>\r\n  );\r\n}\r\n\r\nexport default ForgotPasswordPage;\r\n","import React from 'react';\r\nimport Edit from '@material-ui/icons/Edit';\r\nimport Cancel from '@material-ui/icons/Cancel';\r\nimport Save from '@material-ui/icons/Save';\r\nimport { Grid } from '@material-ui/core';\r\n\r\nfunction EditableFields({\r\n  editable,\r\n  master,\r\n  masterValue,\r\n  slaves,\r\n  slaveValues,\r\n  onSave,\r\n  ...props\r\n}) {\r\n\r\n  const [edit, setEdit] = React.useState(false);\r\n  const [prevMasterValue, setPrevMasterValue] = React.useState();\r\n  const [currMasterValue, setCurrMasterValue] = React.useState(masterValue);\r\n  const [prevSlaveValues, setPrevSlaveValues] = React.useState([]);\r\n  const [currSlaveValues, setCurrSlaveValues] = React.useState(slaveValues);\r\n\r\n  // Handle async passing of master/slave values\r\n  React.useEffect(() => {\r\n    setCurrMasterValue(masterValue);\r\n    setCurrSlaveValues(slaveValues);\r\n  }, [masterValue, slaveValues]);\r\n\r\n  function toggleEdit() {\r\n    setPrevMasterValue(currMasterValue);\r\n    setPrevSlaveValues(currSlaveValues);\r\n    setEdit(!edit);\r\n  }\r\n\r\n  function icons() {\r\n    if (!editable) return null;\r\n    if (edit) {\r\n      return (\r\n        <>\r\n          <Save\r\n            style={{ cursor: 'pointer' }}\r\n            onClick={() => {\r\n              if (currMasterValue == null) return;\r\n              if (onSave) {\r\n                if (currSlaveValues) {\r\n                  onSave(currMasterValue, ...currSlaveValues);\r\n                } else {\r\n                  onSave(currMasterValue);\r\n                }\r\n              }\r\n              toggleEdit();\r\n            }}\r\n          />\r\n          <Cancel\r\n            style={{ cursor: 'pointer' }}\r\n            onClick={() => {\r\n              setCurrMasterValue(prevMasterValue);\r\n              setCurrSlaveValues(prevSlaveValues);\r\n              toggleEdit();\r\n            }}\r\n          />\r\n        </>\r\n      );\r\n    }\r\n    return <Edit style={{ cursor: 'pointer' }} onClick={toggleEdit} />;\r\n  }\r\n  function onSlaveChange(event, valueIndex) {\r\n    let copySlaves = currSlaveValues.map((val, idx) => {\r\n      if (idx === valueIndex) return event.target.value;\r\n      return val;\r\n    });\r\n    setCurrSlaveValues(copySlaves);\r\n  }\r\n\r\n  function onMasterChange(event) {\r\n    setCurrMasterValue(event.target.value);\r\n  }\r\n\r\n  return (\r\n    <Grid container spacing={1} alignItems=\"flex-end\">\r\n      {slaves &&\r\n        slaves.map((slave, idx) => {\r\n          return (\r\n            <Grid item key={idx}>\r\n              {slave({\r\n                value: currSlaveValues[idx] || \"\", // \"\" required for label placeholder mechanics\r\n                InputProps: { readOnly: !edit },\r\n                onChange: (event) => onSlaveChange(event, idx),\r\n              })}\r\n            </Grid>\r\n          );\r\n        })}\r\n      <Grid item>\r\n        {master({\r\n          value: currMasterValue || \"\", // \"\" required for label placeholder mechanics\r\n          InputProps: { readOnly: !edit },\r\n          onChange: onMasterChange,\r\n        })}\r\n      </Grid>\r\n      {editable && <Grid item>{icons()}</Grid>}\r\n    </Grid>\r\n  );\r\n}\r\n\r\nexport default EditableFields;\r\n","import axios from 'axios';\r\nimport React from 'react';\r\nimport { Scatter } from \"react-chartjs-2\";\r\nimport { Typography } from '@material-ui/core';\r\nimport AuthContext from '../../AuthContext';\r\n\r\nfunction UserStats() {\r\n\r\n  const token = React.useContext(AuthContext);\r\n  const [involvementRate, setInvolvementRate] = React.useState(0);\r\n  const [channelsData, setChannelsData] = React.useState([]);\r\n  const [dmsData, setDmsData] = React.useState([]);\r\n  const [messagesData, setMessagesData] = React.useState([]);\r\n\r\n  React.useEffect(() => {\r\n    axios\r\n      .get(`/user/stats/v1`, { params: { token } })\r\n      .then(({ data }) => {\r\n        console.log(data);\r\n        const { user_stats } = data;\r\n        setInvolvementRate(user_stats['involvement_rate']);\r\n        setChannelsData(user_stats['channels_joined'].map((obj) => {\r\n          return { x: new Date(obj['time_stamp'] * 1000), y: obj['num_channels_joined'] };\r\n        }));\r\n        setDmsData(user_stats['dms_joined'].map((obj) => {\r\n          return { x: new Date(obj['time_stamp'] * 1000), y: obj['num_dms_joined'] };\r\n        }));\r\n        setMessagesData(user_stats['messages_sent'].map((obj) => {\r\n          return { x: new Date(obj['time_stamp'] * 1000), y: obj['num_messages_sent'] };\r\n        }));\r\n      })\r\n      .catch((err) => {\r\n        console.error(err);\r\n      })\r\n  }, [token]);\r\n\r\n  return (\r\n    <>\r\n      <Typography variant=\"h5\">User statistics</Typography>\r\n      <p>Involvement rate: {(involvementRate * 100).toFixed(2)}%</p>\r\n      <Scatter\r\n        data={{\r\n          datasets: [\r\n            {\r\n              label: \"Channels joined\",\r\n              data: channelsData,\r\n              fill: false,\r\n              borderColor: \"#742774\",\r\n              showLine: true,\r\n            },\r\n            {\r\n              label: \"Dms joined\",\r\n              data: dmsData,\r\n              fill: false,\r\n              borderColor: \"#4287f5\",\r\n              showLine: true,\r\n            },\r\n            {\r\n              label: \"Messages sent\",\r\n              data: messagesData,\r\n              fill: false,\r\n              borderColor: \"#bd2d4f\",\r\n              showLine: true,\r\n            },\r\n          ]\r\n        }}\r\n        options={{\r\n          scales: {\r\n            xAxes: [{\r\n              title: \"time\",\r\n              type: 'time',\r\n              gridLines: {\r\n                lineWidth: 2\r\n              },\r\n              time: {\r\n                unitStepSize: 200,\r\n                displayFormats: {\r\n                  millisecond: 'MMM DD HH:mm',\r\n                  second: 'MMM DD HH:mm',\r\n                  minute: 'MMM DD HH:mm',\r\n                  hour: 'MMM DD HH:mm',\r\n                  day: 'MMM DD',\r\n                  week: 'MMM DD',\r\n                  month: 'MMM DD',\r\n                  quarter: 'MMM DD',\r\n                  year: 'MMM DD',\r\n                }\r\n              }\r\n            }]\r\n          }\r\n        }}\r\n      />\r\n    </>\r\n  );\r\n}\r\n\r\nexport default UserStats;\r\n","import {\r\n  List,\r\n  ListItem,\r\n  ListSubheader,\r\n  TextField,\r\n  Typography,\r\n} from '@material-ui/core';\r\nimport axios from 'axios';\r\nimport React from 'react';\r\nimport AuthContext from '../../AuthContext';\r\nimport { extractUId } from '../../utils/token';\r\nimport EditableFields from './EditableFields';\r\nimport UserStats from './UserStats';\r\nimport Placeholder from '../Placeholder';\r\n\r\nfunction Profile({ profile }) {\r\n\r\n  const [loading, setLoading] = React.useState(true);\r\n  const [profileDetails, setProfileDetails] = React.useState({});\r\n  const token = React.useContext(AuthContext);\r\n  const u_id = extractUId(token);\r\n\r\n  React.useEffect(() => {\r\n    axios\r\n      .get(`/user/profile/v2`, { params: { token, u_id: profile } })\r\n      .then(({ data }) => {\r\n        console.log(data);\r\n        const { user } = data;\r\n        setProfileDetails(user);\r\n      })\r\n      .catch((err) => {\r\n        console.error(err);\r\n      })\r\n      .finally(() => setLoading(false));\r\n  }, [profile, token]);\r\n\r\n  function updateName(name_last, name_first) {\r\n    axios\r\n      .put(`/user/profile/setname/v2`, { token, name_first, name_last })\r\n      .then(() => {\r\n        console.log('all good');\r\n      })\r\n      .catch((err) => {\r\n        console.error(err);\r\n      });\r\n  }\r\n\r\n  function updateEmail(email) {\r\n    axios\r\n      .put(`/user/profile/setemail/v2`, { token, email })\r\n      .then(() => {\r\n        console.log('all good');\r\n      })\r\n      .catch((err) => {\r\n        console.error(err);\r\n      });\r\n  }\r\n\r\n  function updateProfileImgUrl(raw_text, x_start, y_start, x_end, y_end) {\r\n    const items = raw_text.split(',');\r\n    axios\r\n      .post(`/user/profile/uploadphoto/v1`, {\r\n        token,\r\n        img_url: items[0],\r\n        x_start: Number.parseInt(items[1]),\r\n        y_start: Number.parseInt(items[2]),\r\n        x_end: Number.parseInt(items[3]),\r\n        y_end: Number.parseInt(items[4]),\r\n      })\r\n      .then(() => {\r\n        console.log('all good');\r\n      })\r\n      .catch((err) => {\r\n        console.error(err);\r\n      });\r\n  }\r\n\r\n  function updateHandle(handle_str) {\r\n    axios\r\n      .put(`/user/profile/sethandle/v1`, { token, handle_str })\r\n      .then(() => {\r\n        console.log('all good');\r\n      })\r\n      .catch((err) => {\r\n        console.error(err);\r\n      });\r\n  }\r\n\r\n  const editable = u_id.toString() === profile;\r\n\r\n  return (\r\n    <>\r\n      <Typography variant=\"h4\">Profile</Typography>\r\n      {loading\r\n        ? <Placeholder />\r\n        : <List subheader={<ListSubheader>Profile Details</ListSubheader>}>\r\n          <ListItem key={'name'}>\r\n            <EditableFields\r\n              editable={editable}\r\n              masterValue={profileDetails.name_last}\r\n              slaveValues={[profileDetails.name_first]}\r\n              master={(passed_props) => (\r\n                <TextField label={'Last Name'} {...passed_props} />\r\n              )}\r\n              slaves={[\r\n                (passed_props) => (\r\n                  <TextField label={'First Name'} {...passed_props} />\r\n                ),\r\n              ]}\r\n              onSave={updateName}\r\n            />\r\n          </ListItem>\r\n          <ListItem key={'email'}>\r\n            <EditableFields\r\n              editable={editable}\r\n              masterValue={profileDetails.email}\r\n              master={(passed_props) => (\r\n                <TextField label={'Email'} {...passed_props} />\r\n              )}\r\n              onSave={updateEmail}\r\n            />\r\n          </ListItem>\r\n          <ListItem key={'handle'}>\r\n            <EditableFields\r\n              editable={editable}\r\n              masterValue={profileDetails.handle_str}\r\n              master={(passed_props) => (\r\n                <TextField label={'Handle'} {...passed_props} />\r\n              )}\r\n              onSave={updateHandle}\r\n            />\r\n          </ListItem>\r\n          <ListItem key={'img_url'}>\r\n            <EditableFields\r\n              editable={editable}\r\n              masterValue={profileDetails.profile_img_url}\r\n              master={(passed_props) => (\r\n                <TextField label={'img_url,x1,y1,x2,y2'} {...passed_props} />\r\n              )}\r\n              onSave={updateProfileImgUrl}\r\n            />\r\n          </ListItem>\r\n          <br />\r\n          <div>\r\n            NOTE: The final field input is to set a profile image. Please enter the 5 components (image url,\r\n            x_start, y_start, x_end, y_end) separated by commas.\r\n          </div>\r\n        </List>\r\n      }\r\n      <br />\r\n      {editable && <UserStats />}\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Profile;\r\n","import React from 'react';\r\nimport Layout from '../components/Layout';\r\nimport ProfileChannelLists from '../components/ProfileChannelLists';\r\nimport Profile from '../components/Profile';\r\n\r\nfunction ProfilePage({ match }) {\r\n  const { profile } = match.params;\r\n  return (\r\n    <Layout\r\n      menu={<ProfileChannelLists />}\r\n      body={<Profile profile={profile} />}\r\n    />\r\n  );\r\n}\r\n\r\nexport default ProfilePage;","import {\r\n  Typography, List, ListSubheader,\r\n} from '@material-ui/core';\r\nimport axios from 'axios';\r\nimport React from 'react';\r\nimport LinearProgress from '@material-ui/core/LinearProgress';\r\nimport AuthContext from '../../AuthContext';\r\nimport Message from '../Message';\r\n\r\nfunction Search({ query_str, ...props }) {\r\n\r\n  const [loading, setLoading] = React.useState(true);\r\n  const [messages, setMessages] = React.useState([]);\r\n\r\n  const token = React.useContext(AuthContext);\r\n\r\n  function performSearch() {\r\n    axios\r\n      .get('/search/v2', {\r\n        params: {\r\n          token,\r\n          query_str,\r\n        },\r\n      })\r\n      .then(({ data }) => {\r\n        const { messages } = data;\r\n        if (typeof messages !== \"undefined\" && !Array.isArray(messages)) return;\r\n        setMessages(messages);\r\n        setLoading(false);\r\n      })\r\n      .catch((err) => {\r\n        setLoading(false);\r\n      });\r\n  }\r\n\r\n  // Only perform search if there is a query\r\n  React.useEffect(() => {\r\n    if (query_str !== \"\") performSearch();\r\n  }, [token, query_str])\r\n\r\n  // If there is no query\r\n  if (query_str === \"\") {\r\n    return <>\r\n      <Typography variant=\"h4\" style={{ marginBottom: 10 }}>Search</Typography>\r\n      <Typography variant=\"h6\">Enter a query in the search bar above</Typography>\r\n    </>\r\n  }\r\n\r\n  // If there is a query\r\n  return <>\r\n    <Typography variant=\"h4\" style={{ marginBottom: 10 }}>Search Results</Typography>\r\n    {(loading) ?\r\n      <LinearProgress />\r\n      :\r\n      (messages.length == 0) ?\r\n        <Typography variant=\"h6\">Your search did not return any results</Typography>\r\n        :\r\n        <List\r\n          subheader={<ListSubheader>Messages</ListSubheader>}\r\n          style={{ width: '100%' }}\r\n        >\r\n          {messages.slice().reverse().map((message) => (\r\n            <Message key={message.message_id} {...message} />\r\n          ))}\r\n        </List>\r\n    }\r\n  </>\r\n}\r\n\r\nexport default Search;\r\n","import React from 'react';\r\nimport Layout from '../components/Layout';\r\nimport ProfileChannelLists from '../components/ProfileChannelLists';\r\nimport Search from '../components/Search';\r\n\r\nfunction SearchPage({ match }) {\r\n  const { query_str=\"\" } = match.params;\r\n  return (\r\n    <Layout\r\n      menu={<ProfileChannelLists />}\r\n      body={<Search query_str={query_str} />}\r\n    />\r\n  );\r\n}\r\n\r\nexport default SearchPage;\r\n","import React from 'react';\r\nimport { Redirect, Route } from 'react-router-dom';\r\nimport AuthContext from '../../AuthContext';\r\n\r\nfunction ProtectedRoute(props) {\r\n  const token = React.useContext(AuthContext);\r\n  console.log(token);\r\n  if (!token) {\r\n    return <Redirect to=\"/login\" />;\r\n  }\r\n  return <Route {...props} />;\r\n}\r\n\r\nexport default ProtectedRoute;\r\n","import axios from 'axios';\r\n// import qs from 'qs';\r\nimport _ from 'lodash';\r\n\r\nimport { url } from './utils/constants';\r\nimport { DEFAULT_ERROR_TEXT } from './utils/text';\r\nimport { toast } from 'react-toastify';\r\n\r\naxios.defaults.baseURL = url;\r\naxios.defaults.headers.put['Content-Type'] = 'application/json';\r\naxios.defaults.headers.post['Content-Type'] = 'application/json';\r\naxios.defaults.headers.delete['Content-Type'] = 'application/json';\r\n\r\n// temporarily cancel all requests until backend is ready\r\nconst CancelToken = axios.CancelToken;\r\n\r\naxios.interceptors.request.use((request) => {\r\n    // if (request.method === 'put' || request.method === 'post' || request.method === 'delete') {\r\n    //     request.data = qs.stringify(request.data);\r\n    // }\r\n    return request;\r\n});\r\n\r\nconst errorHandler = (error) => {\r\n    // great gist https://gist.github.com/saqueib/a495af17d7c0e2fd5c2316b0822ebac3\r\n\r\n    // if has response show the error\r\n    console.error(error);\r\n\r\n    let message = DEFAULT_ERROR_TEXT;\r\n\r\n    if (error.response) {\r\n        const found = typeof error.response.data === 'string'\r\n            && error.response.data.match(/<p>(.*)<\\/p>/);\r\n        const responseMessage = found && found.length > 1 && found[1];\r\n        message = _.get(error, 'response.data.message') || responseMessage || DEFAULT_ERROR_TEXT;\r\n    }\r\n\r\n    toast.error(message);\r\n\r\n    return Promise.reject({ ...error })\r\n}\r\n\r\nconst responseHandler = (response) => {\r\n    return response;\r\n}\r\n\r\naxios.interceptors.response.use(responseHandler, errorHandler);","// General POST error\r\nexport const DEFAULT_ERROR_TEXT = 'An error occured. Try again later';\r\n\r\n// Specific GET errors (deprecated)\r\nexport const CHANNEL_ERROR_TEXT = 'Unable to retrieve channel information';\r\n","import React from 'react';\r\nimport { BrowserRouter as Router, Route, Switch } from 'react-router-dom';\r\n\r\nimport './App.css';\r\n\r\nimport HomePage from './pages/HomePage';\r\nimport ChannelPage from './pages/ChannelPage';\r\nimport DmPage from './pages/DmPage';\r\nimport LoginPage from './pages/LoginPage';\r\nimport RegisterPage from './pages/RegisterPage';\r\nimport ForgotPasswordPage from './pages/ForgotPasswordPage';\r\nimport ResetPasswordPage from './pages/ResetPasswordPage';\r\nimport ProfilePage from './pages/ProfilePage';\r\nimport SearchPage from './pages/SearchPage';\r\n\r\nimport ProtectedRoute from './components/Layout/ProtectedRoute';\r\n\r\nimport { AuthProvider } from './AuthContext';\r\nimport './axios';\r\n\r\nfunction App() {\r\n  document.title = 'UNSW Dreams';\r\n\r\n  const [authDetails, setAuthDetails] = React.useState(\r\n    localStorage.getItem('token')\r\n  );\r\n\r\n  function setAuth(token, u_id) {\r\n    localStorage.setItem('token', token);\r\n    localStorage.setItem('u_id', u_id);\r\n    setAuthDetails(token);\r\n  }\r\n  return (\r\n    <AuthProvider value={authDetails}>\r\n      <Router>\r\n        <Switch>\r\n          <Route\r\n            exact\r\n            path=\"/login\"\r\n            render={(props) => {\r\n              return <LoginPage {...props} setAuth={setAuth} />;\r\n            }}\r\n          />\r\n          <Route\r\n            exact\r\n            path=\"/register\"\r\n            render={(props) => {\r\n              return <RegisterPage {...props} setAuth={setAuth} />;\r\n            }}\r\n          />\r\n          <Route exact path=\"/forgot_password\" component={ForgotPasswordPage} />\r\n          <Route exact path=\"/reset_password\" component={ResetPasswordPage} />\r\n          <ProtectedRoute exact path=\"/\" component={HomePage} />\r\n          <ProtectedRoute path=\"/profile/:profile\" component={ProfilePage} />\r\n          <ProtectedRoute path=\"/channel/:channel_id\" component={ChannelPage} />\r\n          <ProtectedRoute path=\"/dm/:dm_id\" component={DmPage} />\r\n          <ProtectedRoute path=\"/search/:query_str\" component={SearchPage} />\r\n          <ProtectedRoute path=\"/search\" component={SearchPage} />\r\n        </Switch>\r\n      </Router>\r\n    </AuthProvider>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then((registration) => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch((error) => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl)\r\n    .then((response) => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then((registration) => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then((registration) => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","import { red } from '@material-ui/core/colors';\r\nimport { createMuiTheme } from '@material-ui/core/styles';\r\n\r\n// A custom theme for this app\r\nconst theme = createMuiTheme({\r\n  palette: {\r\n    primary: {\r\n      main: '#556cd6',\r\n    },\r\n    secondary: {\r\n      main: '#19857b',\r\n    },\r\n    error: {\r\n      main: red.A400,\r\n    },\r\n    background: {\r\n      default: '#fff',\r\n    },\r\n  },\r\n});\r\n\r\nexport default theme;","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\nimport { ThemeProvider } from '@material-ui/styles';\r\nimport { ToastContainer } from 'react-toastify';\r\nimport 'react-toastify/dist/ReactToastify.min.css';\r\nimport './index.css';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\nimport theme from './theme';\r\nimport { MuiPickersUtilsProvider } from '@material-ui/pickers';\r\nimport MomentUtils from '@date-io/moment';\r\n\r\nReactDOM.render(\r\n  <ThemeProvider theme={theme}>\r\n    <MuiPickersUtilsProvider utils={MomentUtils}>\r\n      {/* CssBaseline kickstart an elegant, consistent, and simple baseline to build upon. */}\r\n      <CssBaseline />\r\n      <App />\r\n      <ToastContainer\r\n        position=\"top-center\"\r\n        autoClose={5000}\r\n        hideProgressBar={false}\r\n        newestOnTop\r\n        closeOnClick\r\n        rtl={false}\r\n        pauseOnVisibilityChange\r\n        draggable\r\n        pauseOnHover\r\n      />\r\n    </MuiPickersUtilsProvider>\r\n  </ThemeProvider>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}